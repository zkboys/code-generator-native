(this.webpackJsonp_front=this.webpackJsonp_front||[]).push([[7],{1001:function(e,t,n){var r=n(135),a=n(1002);"string"===typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var c={insert:"head",singleton:!1};r(a,c);e.exports=a.locals||{}},1002:function(e,t,n){"use strict";n.r(t);var r=n(68),a=n.n(r)()(!1);a.push([e.i,".root_3H-yq .front-table-container:before,\n.root_3H-yq .front-table-container:after {\n  display: none;\n}\n.row_OlUvz {\n  display: flex;\n  align-items: center;\n  border-bottom: 1px solid #e8e8e8;\n  background: #FFF;\n  box-sizing: border-box;\n  cursor: move;\n}\n.row_OlUvz .front-form-item {\n  margin: 0 !important;\n  position: relative;\n}\n.row_OlUvz .front-form-item-explain {\n  position: absolute;\n  bottom: -21px;\n  z-index: 10;\n}\n.cell_3GMOg {\n  height: 100%;\n  display: flex;\n  align-items: center;\n  padding: 0 4px;\n  width: 0;\n  box-sizing: border-box;\n}\n.cell_3GMOg .text_30g6_ {\n  width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n",""]),a.locals={antPrefix:"front",raLibPrefix:"front-ra",primaryColor:"#1890ff",root:"root_3H-yq",row:"row_OlUvz",cell:"cell_3GMOg",text:"text_30g6_"},t.default=a},1003:function(e,t,n){var r=n(135),a=n(1004);"string"===typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var c={insert:"head",singleton:!1};r(a,c);e.exports=a.locals||{}},1004:function(e,t,n){"use strict";n.r(t);var r=n(68),a=n.n(r)()(!1);a.push([e.i,".root_22AK4 {\n  background-color: #fafafa;\n}\n.root_22AK4 .front-form-item {\n  margin: 0 !important;\n}\n.root_22AK4 .front-tabs-nav {\n  margin-bottom: 0;\n}\n.root_22AK4 .front-form-item {\n  margin-bottom: 0;\n}\n.root_22AK4 tbody > tr {\n  cursor: move;\n}\n.element_24b-h {\n  position: relative;\n  box-sizing: border-box;\n  width: 100%;\n}\n.element_24b-h.required_1cZgn {\n  padding-left: 10px;\n}\n.element_24b-h.required_1cZgn:before {\n  position: absolute;\n  display: inline-block;\n  left: 0;\n  top: 10px;\n  color: #ff4d4f;\n  font-size: 14px;\n  font-family: SimSun, sans-serif;\n  line-height: 1;\n  content: '*';\n}\n.tabColumn_ihqDw {\n  background: rgba(24, 144, 255, 0.05);\n}\n.helper_qLOjP {\n  display: table-row;\n}\n.helper_qLOjP td {\n  border-bottom: 1px solid #f0f0f0;\n  border-top: 1px solid #f0f0f0;\n  padding: 8px;\n  display: table-cell;\n  vertical-align: center;\n  background: #fff;\n  width: 10000px;\n  border-collapse: collapse;\n}\n.helper_qLOjP .front-form-item_2EPyJ {\n  margin-bottom: 0;\n}\n",""]),a.locals={antPrefix:"front",raLibPrefix:"front-ra",primaryColor:"#1890ff",root:"root_22AK4",element:"element_24b-h",required:"required_1cZgn",tabColumn:"tabColumn_ihqDw",helper:"helper_qLOjP","front-form-item":"front-form-item_2EPyJ"},t.default=a},1005:function(e,t,n){var r=n(135),a=n(1006);"string"===typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var c={insert:"head",singleton:!1};r(a,c);e.exports=a.locals||{}},1006:function(e,t,n){"use strict";n.r(t);var r=n(68),a=n.n(r)()(!1);a.push([e.i,".query_39zez .front-form-item {\n  margin-bottom: 6px;\n}\n.query_39zez .front-form-item-explain {\n  position: absolute;\n  margin-top: -3px;\n  z-index: 10;\n}\n.fileRow_KjD5F {\n  display: flex;\n  align-items: center;\n  padding-top: 7px;\n  background: #eee;\n  position: relative;\n}\n.fileMinus_17Owl {\n  color: red;\n}\n.filePlus_2owcT {\n  color: green;\n}\n.fileOperator_DiSbC {\n  display: flex;\n  align-items: center;\n  position: absolute;\n  left: 10px;\n  top: 0;\n  height: 100%;\n  z-index: 10;\n}\n",""]),a.locals={antPrefix:"front",raLibPrefix:"front-ra",primaryColor:"#1890ff",query:"query_39zez",fileRow:"fileRow_KjD5F",fileMinus:"fileMinus_17Owl",filePlus:"filePlus_2owcT",fileOperator:"fileOperator_DiSbC"},t.default=a},963:function(e,t,n){"use strict";n.r(t);n(323);var r,a=n(175),c=n(235),i=n(21),o=n(157),l=n(38),s=n.n(l),u=n(155),d=(n(322),n(156)),f=n(39),b=n(1),p=n.n(b),j=n(0),m=n(1019),O=n(969),x=n(19),h=n(234),v=n(176),g=n(130),w=(n(113),n(36)),y=n(999),k=(n(204),n(99)),_=(n(534),n(324)),C=(n(536),n(486)),P=n(529),I=n(972),N=n(1018),S=n(992),q=n(967),F=n(538),T=n(1015),E=n(1013),z=n(368),U=n(1001),L=n.n(U),V=n(11),K=Object(x.E)(),M=Object(z.b)((function(e){return e.children})),A=Object(z.a)((function(e){return e.children})),D=_.a.TabPane,R=Object(h.a)({modal:{title:null,width:"80%",top:50,maskClosable:!0}})((function(e){var t=e.params,n=e.onCancel,r=Object(j.useState)(!1),a=Object(f.a)(r,2),c=a[0],i=a[1],o=Object(j.useState)([]),l=Object(f.a)(o,2),d=l[0],b=l[1],p=Object(j.useCallback)(function(){var t=Object(u.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ajax.post("/generate/preview",n,{setLoading:i});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.ajax]);return Object(j.useEffect)((function(){Object(u.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(t);case 2:n=e.sent,b(n);case 4:case"end":return e.stop()}}),e)})))()}),[p,t]),Object(V.jsx)(x.k,{bodyStyle:{padding:0},loading:c,footer:Object(V.jsx)(w.a,{onClick:n,children:"\u5173\u95ed"}),children:Object(V.jsx)(_.a,{type:"card",tabBarStyle:{marginBottom:0,marginTop:13,marginLeft:4},children:d.map((function(e){var t=e.id,n=e.name,r=e.content,a=e.targetPath.split(".").pop();return["jsx","js","vue","vux"].includes(a)&&(a="javascript"),["tsx","ts"].includes(a)&&(a="typescript"),Object(V.jsx)(D,{tab:n,children:Object(V.jsx)(v.a,{otherHeight:80,language:a,value:r,readOnly:!0})},t)}))})})})),B=n(1003),H=n.n(B),J=(r=C.a,function(e){var t=e.columns,n=e.scroll,a=e.className,c=e.onSortEnd,o=Object(j.useState)(0),l=Object(f.a)(o,2),s=l[0],u=l[1],d=t.filter((function(e){return!e.width})).length,b=t.reduce((function(e,t){var n=t.width;return e+(void 0===n?0:n)}),0),m=t.map((function(e){if(e.width)return e;var t=(s-b)/d;return Object(i.a)(Object(i.a)({},e),{},{width:t})})),O=Object(j.useCallback)((function(e){e.oldIndex!==e.newIndex&&c&&c(e)}),[c]);return Object(V.jsx)(E.a,{onResize:function(e){var t=e.width;return u(t)},children:Object(V.jsx)(r,Object(i.a)(Object(i.a)({},e),{},{columns:m,components:{body:function(e){return Object(V.jsx)(A,{onSortEnd:O,helperClass:L.a.row,children:Object(V.jsx)(T.a,{height:n.y,itemCount:e.length,itemSize:50,width:s,children:function(n){var r=n.index,a=n.style;return Object(V.jsx)(M,{index:r,children:Object(V.jsx)("div",{style:a,className:p()(L.a.row),children:m.map((function(n,a){var c=e[r],i=Array.isArray(n.dataIndex)?n.dataIndex.reduce((function(e,t){return e[t]||{}}),c):c[n.dataIndex],o=n.render||function(e){return e},l=a===t.length-1?n.width-K:n.width,s=o(i,c,r);return Object(V.jsx)("div",{style:{width:l},className:p()(L.a.cell),children:"string"===typeof s?Object(V.jsx)("div",{title:s,className:p()(L.a.text),children:o(i,c,r)}):s},n.key||n.dataIndex)}))})})}})})}},className:p()(p()(L.a.root,a))}))})}),G=_.a.TabPane,Z=Object(h.a)()((function(e){console.log("FieldTable render");var t=e.dbUrl,n=e.tableName,r=e.files,l=e.templateOptions,d=e.form,b=Object(j.useState)([]),m=Object(f.a)(b,2),O=m[0],h=m[1],C=Object(j.useState)(!1),T=Object(f.a)(C,2),E=T[0],z=T[1],U=Object(j.useRef)(null),L=Object(x.R)(U,125,[r]),K=Object(f.a)(L,1)[0],M=Object(j.useState)(null),A=Object(f.a)(M,2),D=A[0],B=A[1],Z=Object(j.useState)("type"),Y=Object(f.a)(Z,2),Q=Y[0],W=Y[1],X=Object(j.useState)([]),$=Object(f.a)(X,2),ee=$[0],te=$[1],ne=Object(j.useCallback)(function(){var t=Object(u.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ajax.post("/generate/files",n,{setLoading:z});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.ajax]),re=Object(j.useCallback)(function(){var t=Object(u.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ajax.post("/generate/files/exist",n,{setLoading:z});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.ajax]),ae=Object(j.useCallback)(function(){var t=Object(u.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ajax.get("/db/types",n,{setLoading:z});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.ajax]),ce=Object(j.useCallback)((function(e){var t=e.oldIndex,n=e.newIndex;O.splice.apply(O,[n,0].concat(Object(o.a)(O.splice(t,1)))),h(Object(o.a)(O))}),[O]),ie=Object(j.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=O.length,n={id:Object(q.a)(),comment:"\u65b0\u589e\u5217".concat(t+1),chinese:"\u65b0\u589e\u5217".concat(t+1),field:"field".concat(t+1),formType:"input",dataType:"String",__isNew:!0};e?O.push(n):O.unshift(n),h(Object(o.a)(O))}),[O]),oe=Object(j.useCallback)((function(e){var t=O.filter((function(t){return t.id!==e}));h(t)}),[O]),le=Object(j.useCallback)((function(e,t,n,r,a){var c=e.keyCode,i=e.ctrlKey,o=e.shiftKey,l=e.altKey,s=e.metaKey;if(!(i||o||l||s)){var u=38===c,d=39===c,f=40===c||13===c,b=37===c,p=Object(g.c)(e.target);if((!b||p.start)&&(!d||p.end)){var j,m,O=n*a+1,x=(n+1)*a;if(u){if(t===O)return;j=t-1}if(d&&(n===r-1?t===x?(m=!0,j=a+1):j=t-a*n+1:j=t+a),f&&(t===x?(m=!0,j=t+n+1):j=t+1),b){if(t===O&&0===n)return;0===n&&(j=t-1+a*(r-1)),0!==n&&(j=t-a)}m&&ie(!0),setTimeout((function(){var e=document.querySelector("input[tabindex='".concat(j,"']"));e&&(e.focus(),e.select())}))}}}),[ie]),se=Object(j.useMemo)((function(){return(r||[]).filter((function(e){return e.templateId})).map((function(e){var t,n=e.templateId,r=null===(t=l.find((function(e){return e.value===n})))||void 0===t?void 0:t.record;return{title:null===r||void 0===r?void 0:r.shortName,dataIndex:["options",null===r||void 0===r?void 0:r.id],formProps:{type:"tags",options:(null===r||void 0===r?void 0:r.fieldOptions)||[]}}}))}),[r,l]),ue=0,de=O.length,fe=Object(j.useCallback)((function(e){var t;if(null===e||void 0===e||null===(t=e.formProps)||void 0===t||!t.type)return e;var n=["name","type","length","defaultValue","isNullable"],r=e.title,a=e.dataIndex,o=e.width,l=e.formProps,s=Object(c.a)(e,["title","dataIndex","width","formProps"]),u=l.type,d=void 0===u?"input":u,f=l.required,b=void 0!==f&&f,j=l.options,m=void 0===j?[]:j,O="select"===d?"\u8bf7\u9009\u62e9".concat(r):"\u8bf7\u8f93\u5165".concat(r),h=b?o-18:o-8;"switch"===d&&(h="auto"),h||(h="100%");var g,w=["input"].includes(d);return w&&(g=ue++),Object(i.a)(Object(i.a)({title:r,dataIndex:a,width:o},s),{},{render:function(e,t,r){var c,o=t.__isNew;if(n.includes(a)&&!o)return["select","switch"].includes(d)&&(null===m||void 0===m||null===(c=m.find((function(t){return t.value===e})))||void 0===c?void 0:c.label)||e;var s=["dataSource",r,Array.isArray(a)?a:[a]].flat();if("tags"===d)return Object(V.jsx)("div",{className:p()(p()(H.a.element,b&&H.a.required)),children:Object(V.jsx)(x.e,Object(i.a)(Object(i.a)({},l),{},{name:s,style:{width:h},rules:[{required:b,message:"".concat(O,"!")}],children:Object(V.jsx)(v.f,{options:m})}))});var u={};return w&&(u.tabIndex=de*g+r+1,u.onKeyDown=function(e){return le(e,u.tabIndex,g,ue,de)}),Object(V.jsx)("div",{className:p()(p()(H.a.element,b&&H.a.required)),children:Object(V.jsx)(x.e,Object(i.a)(Object(i.a)(Object(i.a)({},l),u),{},{name:s,style:{width:h},rules:[{required:b,message:"".concat(O,"!")}],placeholder:O}))})}})}),[ue,le,de]),be=Object(j.useMemo)((function(){return[{key:"type",tab:"\u7c7b\u578b&\u9a8c\u8bc1",columns:[{title:"\u6570\u636e\u7c7b\u578b",dataIndex:"dataType",width:150,formProps:{type:"select",options:F.DATA_TYPE_OPTIONS}},{title:"\u8868\u5355\u7c7b\u578b",dataIndex:"formType",width:150,formProps:{type:"select",options:F.FORM_ELEMENT_OPTIONS}},{title:"\u6821\u9a8c\u89c4\u5219",dataIndex:"validation",formProps:{type:"select",mode:"multiple",options:F.VALIDATE_OPTIONS}}]},{key:"options",tab:"\u6a21\u677f\u9009\u9879",columns:Object(o.a)(se)}]}),[se]),pe=Object(j.useMemo)((function(){var e="options"===Q,t=be.find((function(e){return e.key===Q})).columns.map((function(e){return Object(i.a)(Object(i.a)({},e),{},{className:H.a.tabColumn})}));return[{title:"\u64cd\u4f5c",dataIndex:"operator",width:60,render:function(e,t){var n=t.id,r=t.name,a=[{label:"\u5220\u9664",color:"red",confirm:{title:'\u60a8\u786e\u5b9a\u5220\u9664"'.concat(r,'"?'),onConfirm:function(){return oe(n)}}}];return Object(V.jsx)(x.l,{items:a})}},{title:"\u5b57\u6bb5",dataIndex:"name",width:150,formProps:{type:"input",required:!0}},{title:"\u5907\u6ce8",dataIndex:"comment",width:150,formProps:{type:"input",required:!0}},!e&&{title:"\u7c7b\u578b",dataIndex:"type",width:150,formProps:{type:"select",required:!0,options:ee}},!e&&{title:"\u957f\u5ea6",dataIndex:"length",width:85,formProps:{type:"number",min:0,step:1}},!e&&{title:"\u9ed8\u8ba4\u503c",dataIndex:"defaultValue",width:150,formProps:{type:"input"}},!e&&{title:"\u53ef\u4e3a\u7a7a",dataIndex:"isNullable",width:60,formProps:{type:"switch",options:[{value:!0,label:"\u662f"},{value:!1,label:"\u5426"}]}}].concat(Object(o.a)(t)).filter(Boolean).map((function(e){return fe(e)}))}),[Q,ee,oe,fe,be]),je=Object(j.useCallback)(Object(u.a)(s.a.mark((function e(){var t,n,r,a,c,i,o,l,u,f,b,p=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=p.length>0&&void 0!==p[0]&&p[0],e.prev=1,null!==O&&void 0!==O&&O.length){e.next=4;break}return e.abrupt("return",k.a.info({title:"\u6e29\u99a8\u63d0\u793a",content:"\u8868\u683c\u7684\u5b57\u6bb5\u914d\u7f6e\u4e0d\u80fd\u4e3a\u7a7a\uff01"}));case 4:return e.next=6,d.validateFields();case 6:if(n=e.sent,r=n.files,a=n.moduleName,c={moduleName:a,files:r,config:O},!t){e.next=13;break}B(c),e.next=41;break;case 13:return e.next=15,re({files:r});case 15:if(e.t0=e.sent,e.t0){e.next=18;break}e.t0=[];case 18:i=e.t0,o=Object(y.a)(i),e.prev=20,u=s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.value,n=r.find((function(e){return e.targetPath===t})),e.prev=2,e.next=5,Object(x.r)({width:600,title:"\u6587\u4ef6\u5df2\u5b58\u5728",content:t,okText:"\u8986\u76d6",okButtonProps:{danger:!0}});case 5:n.rewrite=!0,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),n.rewrite=!1;case 11:case"end":return e.stop()}}),e,null,[[2,8]])})),o.s();case 23:if((l=o.n()).done){e.next=27;break}return e.delegateYield(u(),"t1",25);case 25:e.next=23;break;case 27:e.next=32;break;case 29:e.prev=29,e.t2=e.catch(20),o.e(e.t2);case 32:return e.prev=32,o.f(),e.finish(32);case 35:return e.next=37,ne(c);case 37:if(null!==(f=e.sent)&&void 0!==f&&f.length){e.next=40;break}return e.abrupt("return",k.a.info({title:"\u6e29\u99a8\u63d0\u793a",content:"\u672a\u751f\u6210\u4efb\u4f55\u6587\u4ef6\uff01"}));case 40:k.a.success({width:600,title:"\u751f\u6210\u6587\u4ef6\u5982\u4e0b",content:Object(V.jsx)("div",{children:f.map((function(e){return Object(V.jsx)("div",{children:e},e)}))})});case 41:e.next=48;break;case 43:if(e.prev=43,e.t3=e.catch(1),null===e.t3||void 0===e.t3||null===(b=e.t3.errorFields)||void 0===b||!b.length){e.next=47;break}return e.abrupt("return",k.a.info({title:"\u6e29\u99a8\u63d0\u793a",content:"\u8868\u5355\u586b\u5199\u6709\u8bef\uff0c\u8bf7\u68c0\u67e5\u540e\u518d\u63d0\u4ea4\uff01"}));case 47:console.error(e.t3);case 48:case"end":return e.stop()}}),e,null,[[1,43],[20,29,32,35]])}))),[d,O,re,ne]),me=Object(j.useCallback)(Object(u.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(x.r)("\u672c\u5730\u540c\u540d\u6a21\u7248\u5c06\u88ab\u8986\u76d6\uff0c\u662f\u5426\u7ee7\u7eed\uff1f");case 2:return t.next=4,e.ajax.get("/templates/local/download",null,{successTip:"\u66f4\u65b0\u6210\u529f\uff01"});case 4:case"end":return t.stop()}}),t)}))),[e.ajax]);return Object(j.useEffect)((function(){Object(u.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae({dbUrl:t});case 2:n=e.sent,te(n);case 4:case"end":return e.stop()}}),e)})))()}),[t,ae]),Object(j.useEffect)((function(){Object(u.a)(s.a.mark((function r(){var a;return s.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t&&n){r.next=2;break}return r.abrupt("return",h([]));case 2:return r.next=4,e.ajax.get("/db/tables/".concat(n),{dbUrl:t},{errorTip:!1,setLoading:z});case 4:a=r.sent,h(a);case 6:case"end":return r.stop()}}),r)})))()}),[t,n,e.ajax]),Object(j.useEffect)((function(){Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:se.forEach((function(e){var n=Object(f.a)(e.dataIndex,2)[1],r=Object(o.a)(e.formProps.options);O.forEach((function(e){e.options||(e.options={}),e.options[n]||(e.options[n]=Object(o.a)(r),t=!0)}))})),h(t?Object(o.a)(O):O);case 2:case"end":return e.stop()}}),e)})))()}),[O,se]),Object(j.useEffect)((function(){return d.setFieldsValue({dataSource:O})}),[d,O]),Object(V.jsxs)(x.c,{loading:E,ref:U,className:p()(H.a.root),children:[Object(V.jsx)(x.e,{noStyle:!0,shouldUpdate:!0,children:function(e){((0,e.getFieldValue)("dataSource")||[]).forEach((function(e){var t=O.find((function(t){return t.id===e.id}));t&&Object.entries(e).forEach((function(e){var n=Object(f.a)(e,2),r=n[0],a=n[1];t[r]=a}))}))}}),Object(V.jsx)(_.a,{tabBarExtraContent:{left:Object(V.jsxs)(a.b,{style:{marginRight:16},children:[Object(V.jsx)(w.a,{icon:Object(V.jsx)(P.a,{}),type:"primary",ghost:!0,onClick:function(){return ie()},children:"\u6dfb\u52a0\u4e00\u884c"}),Object(V.jsx)(w.a,{icon:Object(V.jsx)(I.a,{}),onClick:function(){return je(!0)},children:"\u4ee3\u7801\u9884\u89c8"}),Object(V.jsx)(w.a,{type:"primary",danger:!0,icon:Object(V.jsx)(N.a,{}),onClick:function(){return je()},children:"\u751f\u6210\u6587\u4ef6"})]}),right:Object(V.jsx)(w.a,{icon:Object(V.jsx)(S.a,{}),onClick:me,children:"\u66f4\u65b0\u672c\u5730\u6a21\u7248"})},activeKey:Q,onChange:W,children:be.map((function(e){return Object(V.jsx)(G,{tab:e.tab},e.key)}))}),Object(V.jsx)(J,{onSortEnd:ce,size:"small",columns:pe,pagination:!1,dataSource:O,rowKey:"id",scroll:{y:K}}),Object(V.jsx)(R,{visible:!!D,params:D,onOk:function(){return B(null)},onCancel:function(){return B(null)}})]})})),Y=n(1005),Q=n.n(Y);t.default=Object(h.a)({path:"/",title:"\u9996\u9875"})((function(e){var t=Object(j.useState)([]),n=Object(f.a)(t,2),r=n[0],l=n[1],b=Object(j.useState)([]),h=Object(f.a)(b,2),w=h[0],y=h[1],k=Object(j.useState)({}),_=Object(f.a)(k,2),C=_[0],P=_[1],I=d.a.useForm(),N=Object(f.a)(I,1)[0],S=Object(j.useCallback)(function(){var t=Object(u.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ajax.get("/db/tables",{dbUrl:n},{errorTip:!1});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.ajax]),q=Object(j.useCallback)(function(){var t=Object(u.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ajax.get("/moduleNames/".concat(n),null,{errorTip:!1});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.ajax]),F=Object(j.useCallback)(Object(u.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ajax.get("/templates",null,{errorTip:!1});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),[e.ajax]),T=Object(j.useCallback)(function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=t.target.value,x.N.local.setItem("dbUrl",r),e.next=5,S(r);case 5:a=e.sent,n=a.map((function(e){return{value:e.name,label:e.name}})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),n=[];case 12:l(n);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),[S]),E=Object(j.useCallback)(function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q(t);case 2:n=e.sent,P(n),N.setFieldsValue({moduleName:n["module-name"]});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[q,N]),z=Object(j.useCallback)(function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.value){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,q(n);case 5:r=e.sent,P(r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[q]),U=Object(j.useCallback)((function(e,t){var n=w.find((function(e){return e.value===t})).record,r=n.targetPath,a=n.options,c=N.getFieldValue("files"),l=N.getFieldValue(["files",e]);l.targetPath=r,l.options=Object(o.a)(a),c[e]=l,N.setFieldsValue({files:Object(o.a)(c)}),P(Object(i.a)({},C))}),[N,w,C]),L=Object(j.useCallback)((function(){Object(g.g)()}),[]);Object(j.useEffect)((function(){Object(u.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F();case 2:t=e.sent,n=t.map((function(e){return{record:e,value:e.id,label:e.name}})),y(n);case 5:case"end":return e.stop()}}),e)})))()}),[F]),Object(j.useEffect)((function(){Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=x.N.local.getItem("dbUrl")){e.next=3;break}return e.abrupt("return");case 3:return N.setFieldsValue({dbUrl:t}),e.next=6,T({target:{value:t}});case 6:case"end":return e.stop()}}),e)})))()}),[N,T]),Object(j.useEffect)((function(){var e=(N.getFieldValue("files")||[]).map((function(e){if(e.targetPath){var t=w.find((function(t){return t.value===e.templateId})).record;e.targetPath=Object(g.d)(t.targetPath,C)}return Object(i.a)({},e)}));N.setFieldsValue({files:e})}),[N,C,w]);var K={};return console.log("index render"),Object(V.jsx)(x.m,{className:p()(Q.a.root),children:Object(V.jsxs)(d.a,{style:{marginBottom:8},form:N,layout:"inline",initialValues:{files:[{}]},onValuesChange:L,className:p()(Q.a.query),children:[Object(V.jsx)(x.e,Object(i.a)(Object(i.a)({},K),{},{labelCol:{flex:"100px"},style:{width:300},align:"right",label:"\u6570\u636e\u5e93",name:"dbUrl",placeholder:"mysql://username:password@host:port/database",onChange:T,tooltip:"\u652f\u6301mysql\u3001oracle"})),Object(V.jsx)(x.e,Object(i.a)(Object(i.a)({},K),{},{labelCol:{flex:"100px"},style:{width:308},type:"select",showSearch:!0,label:"\u6570\u636e\u5e93\u8868",name:"tableName",onChange:E,options:r})),Object(V.jsx)(x.e,Object(i.a)(Object(i.a)({},K),{},{labelCol:{flex:"91px"},style:{width:200},label:"\u6a21\u5757\u540d",name:"moduleName",placeholder:"\u6bd4\u5982\uff1auser-center",onBlur:z,required:!0})),Object(V.jsx)("div",{style:{width:"100%",marginTop:8},children:Object(V.jsx)(d.a.List,{name:"files",children:function(e,t){var n=t.add,r=t.remove;return Object(V.jsx)(V.Fragment,{children:e.map((function(t,o){var l=t.key,s=t.name,u=(t.isListField,Object(c.a)(t,["key","name","isListField"])),d=o===e.length-1,f=o+1,b=f;return 0===o&&(b="\u6587\u4ef6".concat(f)),Object(V.jsxs)("div",{className:p()(Q.a.fileRow),children:[Object(V.jsxs)(a.b,{className:p()(Q.a.fileOperator),children:[d&&e.length<w.length&&Object(V.jsx)(m.a,{onClick:function(){return n({})},className:p()(Q.a.filePlus)}),(null===e||void 0===e?void 0:e.length)>1&&Object(V.jsx)(O.a,{onClick:function(){return r(s)},className:p()(Q.a.fileMinus)})]}),Object(V.jsx)(x.e,{noStyle:!0,shouldUpdate:!0,children:function(e){var t=e.getFieldValue,n=t("files"),r=t(["files",s,"templateId"]),a=w.filter((function(e){return r===e.value||!n.find((function(t){return t.templateId===e.value}))}));return Object(V.jsx)("div",{style:{width:318},children:Object(V.jsx)(x.e,Object(i.a)(Object(i.a)(Object(i.a)({},K),u),{},{labelCol:{flex:"100px",style:{userSelect:"none"}},style:{width:200},label:b,name:[s,"templateId"],rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6a21\u677f\u6587\u4ef6\uff01"}],options:a,placeholder:"\u8bf7\u9009\u62e9\u6a21\u677f",onChange:function(e){return U(s,e)}}))})}}),Object(V.jsx)(x.e,Object(i.a)(Object(i.a)(Object(i.a)({},K),u),{},{style:{width:400},label:"\u76ee\u6807\u4f4d\u7f6e",name:[s,"targetPath"],placeholder:"\u8bf7\u8f93\u5165\u76ee\u6807\u6587\u4ef6\u4f4d\u7f6e",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u76ee\u6807\u6587\u4ef6\u4f4d\u7f6e\uff01"},{validator:function(e,t){return t&&N.getFieldValue("files").filter((function(e){return e.targetPath===t})).length>1?Promise.reject("\u4e0d\u80fd\u4f7f\u7528\u76f8\u540c\u7684\u76ee\u6807\u6587\u4ef6\uff01\u8bf7\u4fee\u6539"):Promise.resolve()}}]})),Object(V.jsx)(x.e,{noStyle:!0,shouldUpdate:!0,children:function(e){var t,n=(0,e.getFieldValue)(["files",s,"templateId"]),r=null===(t=w.find((function(e){return e.value===n})))||void 0===t?void 0:t.record,a=(null===r||void 0===r?void 0:r.options)||[];return Object(V.jsx)(x.e,Object(i.a)(Object(i.a)(Object(i.a)({},K),u),{},{name:[s,"options"],children:Object(V.jsx)(v.f,{options:a})}))}})]},l)}))})}})}),Object(V.jsx)(x.e,{shouldUpdate:function(e,t){return["dbUrl","tableName","moduleName","files"].some((function(n){return(null===e||void 0===e?void 0:e[n])!==(null===t||void 0===t?void 0:t[n])}))},noStyle:!0,children:function(e){var t=(0,e.getFieldsValue)(),n=t.dbUrl,r=t.tableName,a=t.files;return Object(V.jsx)(Z,{form:N,dbUrl:n,tableName:r,files:a,templateOptions:w})}})]})})}))}}]);