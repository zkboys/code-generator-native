(this.webpackJsonp_front=this.webpackJsonp_front||[]).push([[7],{1003:function(e,t,n){var a=n(135),r=n(1004);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},1004:function(e,t,n){"use strict";n.r(t);var a=n(68),r=n.n(a)()(!1);r.push([e.i,".root_3H-yq .front-table-container:before,\n.root_3H-yq .front-table-container:after {\n  display: none;\n}\n.row_OlUvz {\n  display: flex;\n  align-items: center;\n  border-bottom: 1px solid #e8e8e8;\n  background: #FFF;\n  box-sizing: border-box;\n  cursor: move;\n}\n.row_OlUvz .front-form-item {\n  margin: 0 !important;\n  position: relative;\n}\n.row_OlUvz .front-form-item-explain {\n  position: absolute;\n  bottom: -21px;\n  z-index: 10;\n}\n.cell_3GMOg {\n  height: 100%;\n  display: flex;\n  align-items: center;\n  padding: 0 4px;\n  width: 0;\n  box-sizing: border-box;\n}\n.cell_3GMOg .text_30g6_ {\n  width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n",""]),r.locals={antPrefix:"front",raLibPrefix:"front-ra",primaryColor:"#1890ff",root:"root_3H-yq",row:"row_OlUvz",cell:"cell_3GMOg",text:"text_30g6_"},t.default=r},1005:function(e,t,n){var a=n(135),r=n(1006);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},1006:function(e,t,n){"use strict";n.r(t);var a=n(68),r=n.n(a)()(!1);r.push([e.i,".root_22AK4 {\n  background-color: #fafafa;\n}\n.root_22AK4 .front-form-item {\n  margin: 0 !important;\n}\n.root_22AK4 .front-tabs-nav {\n  margin-bottom: 0;\n}\n.root_22AK4 .front-form-item {\n  margin-bottom: 0;\n}\n.root_22AK4 tbody > tr {\n  cursor: move;\n}\n.element_24b-h {\n  position: relative;\n  box-sizing: border-box;\n  width: 100%;\n}\n.element_24b-h.required_1cZgn {\n  padding-left: 10px;\n}\n.element_24b-h.required_1cZgn:before {\n  position: absolute;\n  display: inline-block;\n  left: 0;\n  top: 10px;\n  color: #ff4d4f;\n  font-size: 14px;\n  font-family: SimSun, sans-serif;\n  line-height: 1;\n  content: '*';\n}\n.tabColumn_ihqDw {\n  background: rgba(24, 144, 255, 0.05);\n}\n.helper_qLOjP {\n  display: table-row;\n}\n.helper_qLOjP td {\n  border-bottom: 1px solid #f0f0f0;\n  border-top: 1px solid #f0f0f0;\n  padding: 8px;\n  display: table-cell;\n  vertical-align: center;\n  background: #fff;\n  width: 10000px;\n  border-collapse: collapse;\n}\n.helper_qLOjP .front-form-item_2EPyJ {\n  margin-bottom: 0;\n}\n",""]),r.locals={antPrefix:"front",raLibPrefix:"front-ra",primaryColor:"#1890ff",root:"root_22AK4",element:"element_24b-h",required:"required_1cZgn",tabColumn:"tabColumn_ihqDw",helper:"helper_qLOjP","front-form-item":"front-form-item_2EPyJ"},t.default=r},1008:function(e,t,n){var a=n(135),r=n(1009);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},1009:function(e,t,n){"use strict";n.r(t);var a=n(68),r=n.n(a)()(!1);r.push([e.i,".root_IP7AU {\n  height: 100vh;\n  overflow: hidden;\n  margin: 0;\n}\n.query_39zez .front-form-item {\n  margin-bottom: 6px;\n}\n.query_39zez .front-form-item-explain {\n  position: absolute;\n  margin-top: -3px;\n  z-index: 10;\n}\n.fileRow_KjD5F {\n  display: flex;\n  align-items: center;\n  padding-top: 7px;\n  background: #eee;\n  position: relative;\n}\n.fileMinus_17Owl,\n.filePlus_2owcT {\n  width: 14px;\n  height: 14px;\n}\n.fileOperator_DiSbC {\n  display: flex;\n  align-items: center;\n  position: absolute;\n  left: 5px;\n  top: -2px;\n  height: 100%;\n  z-index: 10;\n}\n",""]),r.locals={antPrefix:"front",raLibPrefix:"front-ra",primaryColor:"#1890ff",root:"root_IP7AU",query:"query_39zez",fileRow:"fileRow_KjD5F",fileMinus:"fileMinus_17Owl",filePlus:"filePlus_2owcT",fileOperator:"fileOperator_DiSbC"},t.default=r},960:function(e,t,n){"use strict";n.r(t);n(323);var a,r=n(175),i=(n(113),n(36)),c=n(235),o=n(21),l=n(157),s=n(38),u=n.n(s),d=n(155),f=(n(322),n(156)),b=n(39),p=n(1),j=n.n(p),m=n(0),O=n(968),x=n(1026),h=n(19),v=n(234),g=n(176),w=n(1001),y=(n(204),n(99)),k=(n(533),n(324)),_=(n(536),n(486)),C=n(529),P=n(971),I=n(1025),N=n(992),S=n(1024),T=n(966),q=n(130),E=n(538),F=n(1020),A=n(1016),L=n(368),V=n(1003),z=n.n(V),U=n(11),K=Object(h.E)(),M=Object(L.b)((function(e){return e.children})),R=Object(L.a)((function(e){return e.children})),D=k.a.TabPane,B=Object(v.a)({modal:{title:null,width:"80%",top:50,maskClosable:!0}})((function(e){var t=e.params,n=e.onCancel,a=Object(m.useState)(!1),r=Object(b.a)(a,2),c=r[0],o=r[1],l=Object(m.useState)([]),s=Object(b.a)(l,2),f=s[0],p=s[1],j=Object(m.useCallback)(function(){var t=Object(d.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ajax.post("/generate/preview",n,{setLoading:o});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.ajax]);return Object(m.useEffect)((function(){Object(d.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(t);case 2:n=e.sent,p(n);case 4:case"end":return e.stop()}}),e)})))()}),[j,t]),Object(U.jsx)(h.k,{bodyStyle:{padding:0},loading:c,footer:Object(U.jsx)(i.a,{onClick:n,children:"\u5173\u95ed"}),children:Object(U.jsx)(k.a,{type:"card",tabBarStyle:{marginBottom:0,marginTop:13,marginLeft:4},children:f.map((function(e){var t=e.id,n=e.name,a=e.content,r=e.targetPath.split(".").pop();return["jsx","js","vue","vux"].includes(r)&&(r="javascript"),["tsx","ts"].includes(r)&&(r="typescript"),Object(U.jsx)(D,{tab:n,children:Object(U.jsx)(g.a,{otherHeight:80,language:r,value:a,readOnly:!0})},t)}))})})})),H=n(1005),J=n.n(H),G=(a=_.a,function(e){var t=e.columns,n=e.scroll,r=e.className,i=e.onSortEnd,c=Object(m.useState)(0),l=Object(b.a)(c,2),s=l[0],u=l[1],d=t.filter((function(e){return!e.width})).length,f=t.reduce((function(e,t){var n=t.width;return e+(void 0===n?0:n)}),0),p=t.map((function(e){if(e.width)return e;var t=(s-f)/d;return Object(o.a)(Object(o.a)({},e),{},{width:t})})),O=Object(m.useCallback)((function(e){e.oldIndex!==e.newIndex&&i&&i(e)}),[i]);return Object(U.jsx)(A.a,{onResize:function(e){var t=e.width;return u(t)},children:Object(U.jsx)(a,Object(o.a)(Object(o.a)({},e),{},{columns:p,components:{body:function(e){return Object(U.jsx)(R,{onSortEnd:O,shouldCancelStart:function(e){var t=e.target,n=t.tagName,a=t.classList;return!!["A","INPUT","SELECT","BUTTON","TEXTAREA","OPTION"].includes(n)||String(a).includes("select-selection")},helperClass:z.a.row,children:Object(U.jsx)(F.a,{height:n.y,itemCount:e.length,itemSize:50,width:s,children:function(n){var a=n.index,r=n.style;return Object(U.jsx)(M,{index:a,children:Object(U.jsx)("div",{style:r,className:j()(z.a.row),children:p.map((function(n,r){var i=e[a],c=Array.isArray(n.dataIndex)?n.dataIndex.reduce((function(e,t){return e[t]||{}}),i):i[n.dataIndex],o=n.render||function(e){return e},l=r===t.length-1?n.width-K:n.width,s=o(c,i,a);return Object(U.jsx)("div",{style:{width:l},className:j()(z.a.cell),children:"string"===typeof s?Object(U.jsx)("div",{title:s,className:j()(z.a.text),children:o(c,i,a)}):s},n.key||n.dataIndex)}))})})}})})}},className:j()(j()(z.a.root,r))}))})}),Z=k.a.TabPane,Y=Object(v.a)()((function(e){var t=e.templateOptions,n=e.form,a=n.getFieldsValue(),s=a.dbUrl,f=a.tableName,p=a.files,O=Object(m.useState)([]),x=Object(b.a)(O,2),v=x[0],_=x[1],F=Object(m.useState)(!1),A=Object(b.a)(F,2),L=A[0],V=A[1],z=Object(m.useRef)(null),K=Object(h.R)(z,110,[p]),M=Object(b.a)(K,1)[0],R=Object(m.useState)(null),D=Object(b.a)(R,2),H=D[0],Y=D[1],X=Object(m.useState)("type"),Q=Object(b.a)(X,2),W=Q[0],$=Q[1],ee=Object(m.useState)([]),te=Object(b.a)(ee,2),ne=te[0],ae=te[1],re=Object(m.useCallback)(function(){var t=Object(d.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ajax.post("/generate/files",n,{setLoading:V});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.ajax]),ie=Object(m.useCallback)(function(){var t=Object(d.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ajax.post("/generate/files/exist",n,{setLoading:V});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.ajax]),ce=Object(m.useCallback)(function(){var t=Object(d.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ajax.get("/db/types",n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.ajax]),oe=Object(m.useCallback)((function(e){var t=e.oldIndex,n=e.newIndex;v.splice.apply(v,[n,0].concat(Object(l.a)(v.splice(t,1)))),_(Object(l.a)(v))}),[v]),le=Object(m.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=v.length,n={id:Object(T.a)(),comment:"\u65b0\u589e\u5217".concat(t+1),chinese:"\u65b0\u589e\u5217".concat(t+1),field:"field".concat(t+1),formType:"input",dataType:"String",__isNew:!0};e?v.push(n):v.unshift(n),_(Object(l.a)(v))}),[v]),se=Object(m.useCallback)((function(e){var t=v.filter((function(t){return t.id!==e}));_(t)}),[v]),ue=Object(m.useCallback)((function(e,t,n,a,r){var i=e.keyCode,c=e.ctrlKey,o=e.shiftKey,l=e.altKey,s=e.metaKey;if(!(c||o||l||s)){var u=38===i,d=39===i,f=40===i||13===i,b=37===i,p=Object(q.c)(e.target);if((!b||p.start)&&(!d||p.end)){var j,m,O=n*r+1,x=(n+1)*r;if(u){if(t===O)return;j=t-1}if(d&&(n===a-1?t===x?(m=!0,j=r+1):j=t-r*n+1:j=t+r),f&&(t===x?(m=!0,j=t+n+1):j=t+1),b){if(t===O&&0===n)return;0===n&&(j=t-1+r*(a-1)),0!==n&&(j=t-r)}m&&le(!0),setTimeout((function(){var e=document.querySelector("input[tabindex='".concat(j,"']"));e&&(e.focus(),e.select())}))}}}),[le]),de=Object(m.useMemo)((function(){return(p||[]).filter((function(e){return e.templateId})).map((function(e){var n,a=e.templateId,r=null===(n=t.find((function(e){return e.value===a})))||void 0===n?void 0:n.record;return{title:null===r||void 0===r?void 0:r.shortName,dataIndex:["options",null===r||void 0===r?void 0:r.id],formProps:{type:"tags",options:(null===r||void 0===r?void 0:r.fieldOptions)||[]}}}))}),[p,t]),fe=0,be=v.length,pe=Object(m.useCallback)((function(e){var t;if(null===e||void 0===e||null===(t=e.formProps)||void 0===t||!t.type)return e;var n=["name","type","length","defaultValue","isNullable"],a=e.title,r=e.dataIndex,i=e.width,l=e.formProps,s=Object(c.a)(e,["title","dataIndex","width","formProps"]),u=l.type,d=void 0===u?"input":u,f=l.required,b=void 0!==f&&f,p=l.options,m=void 0===p?[]:p,O="select"===d?"\u8bf7\u9009\u62e9".concat(a):"\u8bf7\u8f93\u5165".concat(a),x=b?i-18:i-8;"switch"===d&&(x="auto"),x||(x="100%");var v,w=["input"].includes(d);return w&&(v=fe++),Object(o.a)(Object(o.a)({title:a,dataIndex:r,width:i},s),{},{render:function(e,t,a){var i,c=t.__isNew;if(n.includes(r)&&!c)return["select","switch"].includes(d)&&(null===m||void 0===m||null===(i=m.find((function(t){return t.value===e})))||void 0===i?void 0:i.label)||e;var s=["dataSource",a,Array.isArray(r)?r:[r]].flat();if("tags"===d)return Object(U.jsx)("div",{className:j()(j()(J.a.element,b&&J.a.required)),children:Object(U.jsx)(h.e,Object(o.a)(Object(o.a)({},l),{},{name:s,style:{width:x},rules:[{required:b,message:"".concat(O,"!")}],children:Object(U.jsx)(g.f,{options:m})}))});var u={};return w&&(u.tabIndex=be*v+a+1,u.onKeyDown=function(e){return ue(e,u.tabIndex,v,fe,be)}),Object(U.jsx)("div",{className:j()(j()(J.a.element,b&&J.a.required)),children:Object(U.jsx)(h.e,Object(o.a)(Object(o.a)(Object(o.a)({},l),u),{},{name:s,style:{width:x},rules:[{required:b,message:"".concat(O,"!")}],placeholder:O}))})}})}),[fe,ue,be]),je=Object(m.useMemo)((function(){return[{key:"type",tab:"\u7c7b\u578b&\u9a8c\u8bc1",columns:[{title:"\u6570\u636e\u7c7b\u578b",dataIndex:"dataType",width:150,formProps:{type:"select",options:E.DATA_TYPE_OPTIONS}},{title:"\u8868\u5355\u7c7b\u578b",dataIndex:"formType",width:150,formProps:{type:"select",options:E.FORM_ELEMENT_OPTIONS}},{title:"\u6821\u9a8c\u89c4\u5219",dataIndex:"validation",formProps:{type:"select",mode:"multiple",options:E.VALIDATE_OPTIONS}}]},{key:"options",tab:"\u6a21\u677f\u9009\u9879",columns:Object(l.a)(de)}]}),[de]),me=Object(m.useMemo)((function(){var e="options"===W,t=je.find((function(e){return e.key===W})).columns.map((function(e){return Object(o.a)(Object(o.a)({},e),{},{className:J.a.tabColumn})}));return[{title:"\u64cd\u4f5c",dataIndex:"operator",width:60,render:function(e,t){var n=t.id,a=t.name,r=[{label:"\u5220\u9664",color:"red",confirm:{title:'\u60a8\u786e\u5b9a\u5220\u9664"'.concat(a,'"?'),onConfirm:function(){return se(n)}}}];return Object(U.jsx)(h.l,{items:r})}},{title:"\u5b57\u6bb5",dataIndex:"name",width:150,formProps:{type:"input",required:!0}},{title:"\u5907\u6ce8",dataIndex:"comment",width:150,formProps:{type:"input",required:!0}},!e&&{title:"\u7c7b\u578b",dataIndex:"type",width:150,formProps:{type:"select",required:!0,options:ne}},!e&&{title:"\u957f\u5ea6",dataIndex:"length",width:85,formProps:{type:"number",min:0,step:1}},!e&&{title:"\u9ed8\u8ba4\u503c",dataIndex:"defaultValue",width:150,formProps:{type:"input"}},!e&&{title:"\u53ef\u4e3a\u7a7a",dataIndex:"isNullable",width:60,formProps:{type:"switch",options:[{value:!0,label:"\u662f"},{value:!1,label:"\u5426"}]}}].concat(Object(l.a)(t)).filter(Boolean).map((function(e){return pe(e)}))}),[W,ne,se,pe,je]),Oe=Object(m.useCallback)(Object(d.a)(u.a.mark((function e(){var t,a,r,i,c,l,s,d,f,b,p,j,m=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=m.length>0&&void 0!==m[0]&&m[0],e.prev=1,null!==v&&void 0!==v&&v.length){e.next=4;break}return e.abrupt("return",y.a.info({title:"\u6e29\u99a8\u63d0\u793a",content:"\u8868\u683c\u7684\u5b57\u6bb5\u914d\u7f6e\u4e0d\u80fd\u4e3a\u7a7a\uff01"}));case 4:return e.next=6,n.validateFields();case 6:if(a=e.sent,r=a.files,i=a.moduleName,c=v.map((function(e){var t,n=null===(t=e.validation)||void 0===t?void 0:t.map((function(e){var t,n=E.VALIDATE_OPTIONS.find((function(t){return t.value===e}));return Object(o.a)(Object(o.a)({},n),{},{pattern:null===(t=n.pattern)||void 0===t?void 0:t.toString()})}));return Object(o.a)(Object(o.a)({},e),{},{validation:n})})),l={moduleName:i,files:r,config:c},!t){e.next=14;break}Y(l),e.next=42;break;case 14:return e.next=16,ie({files:r});case 16:if(e.t0=e.sent,e.t0){e.next=19;break}e.t0=[];case 19:s=e.t0,d=Object(w.a)(s),e.prev=21,b=u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.value,n=r.find((function(e){return e.targetPath===t})),e.prev=2,e.next=5,Object(h.r)({width:600,title:"\u6587\u4ef6\u5df2\u5b58\u5728",content:t,okText:"\u8986\u76d6",okButtonProps:{danger:!0}});case 5:n.rewrite=!0,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),n.rewrite=!1;case 11:case"end":return e.stop()}}),e,null,[[2,8]])})),d.s();case 24:if((f=d.n()).done){e.next=28;break}return e.delegateYield(b(),"t1",26);case 26:e.next=24;break;case 28:e.next=33;break;case 30:e.prev=30,e.t2=e.catch(21),d.e(e.t2);case 33:return e.prev=33,d.f(),e.finish(33);case 36:return e.next=38,re(l);case 38:if(null!==(p=e.sent)&&void 0!==p&&p.length){e.next=41;break}return e.abrupt("return",y.a.info({title:"\u6e29\u99a8\u63d0\u793a",content:"\u672a\u751f\u6210\u4efb\u4f55\u6587\u4ef6\uff01"}));case 41:y.a.success({width:600,title:"\u751f\u6210\u6587\u4ef6\u5982\u4e0b",content:Object(U.jsx)("div",{children:p.map((function(e){return Object(U.jsx)("div",{children:e},e)}))})});case 42:e.next=49;break;case 44:if(e.prev=44,e.t3=e.catch(1),null===e.t3||void 0===e.t3||null===(j=e.t3.errorFields)||void 0===j||!j.length){e.next=48;break}return e.abrupt("return",y.a.info({title:"\u6e29\u99a8\u63d0\u793a",content:"\u8868\u5355\u586b\u5199\u6709\u8bef\uff0c\u8bf7\u68c0\u67e5\u540e\u518d\u63d0\u4ea4\uff01"}));case 48:console.error(e.t3);case 49:case"end":return e.stop()}}),e,null,[[1,44],[21,30,33,36]])}))),[n,v,ie,re]),xe=Object(m.useCallback)(Object(d.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(h.r)("\u672c\u5730\u540c\u540d\u6a21\u7248\u5c06\u88ab\u8986\u76d6\uff0c\u662f\u5426\u7ee7\u7eed\uff1f");case 2:return t.next=4,e.ajax.get("/templates/local/download",null,{successTip:"\u66f4\u65b0\u6210\u529f\uff01"});case 4:case"end":return t.stop()}}),t)}))),[e.ajax]);return Object(S.a)((function(){Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce({dbUrl:s});case 2:t=e.sent,ae(t);case 4:case"end":return e.stop()}}),e)})))()}),[s,ce],{wait:500}),Object(S.a)((function(){Object(d.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s&&f){t.next=2;break}return t.abrupt("return",_([]));case 2:return t.next=4,e.ajax.get("/db/tables/".concat(f),{dbUrl:s},{setLoading:V});case 4:n=t.sent,_(n);case 6:case"end":return t.stop()}}),t)})))()}),[s,f,e.ajax],{wait:500}),Object(m.useEffect)((function(){Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:de.forEach((function(e){var n=Object(b.a)(e.dataIndex,2)[1],a=Object(l.a)(e.formProps.options);v.forEach((function(e){e.options||(e.options={}),e.options[n]||(e.options[n]=Object(l.a)(a),t=!0)}))})),_(t?Object(l.a)(v):v);case 2:case"end":return e.stop()}}),e)})))()}),[v,de]),Object(m.useEffect)((function(){return n.setFieldsValue({dataSource:v})}),[n,v]),Object(U.jsxs)(h.c,{loading:L,ref:z,className:j()(J.a.root),children:[Object(U.jsx)(h.e,{noStyle:!0,shouldUpdate:!0,children:function(e){((0,e.getFieldValue)("dataSource")||[]).forEach((function(e){var t=v.find((function(t){return t.id===e.id}));t&&Object.entries(e).forEach((function(e){var n=Object(b.a)(e,2),a=n[0],r=n[1];t[a]=r}))}))}}),Object(U.jsx)(k.a,{tabBarExtraContent:{left:Object(U.jsxs)(r.b,{style:{marginRight:16},children:[Object(U.jsx)(i.a,{icon:Object(U.jsx)(C.a,{}),type:"primary",ghost:!0,onClick:function(){return le()},children:"\u6dfb\u52a0\u4e00\u884c"}),Object(U.jsx)(i.a,{icon:Object(U.jsx)(P.a,{}),onClick:function(){return Oe(!0)},children:"\u4ee3\u7801\u9884\u89c8"}),Object(U.jsx)(i.a,{type:"primary",danger:!0,icon:Object(U.jsx)(I.a,{}),onClick:function(){return Oe()},children:"\u751f\u6210\u6587\u4ef6"})]}),right:Object(U.jsx)(i.a,{icon:Object(U.jsx)(N.a,{}),onClick:xe,children:"\u66f4\u65b0\u672c\u5730\u6a21\u7248"})},activeKey:W,onChange:$,children:je.map((function(e){return Object(U.jsx)(Z,{tab:e.tab},e.key)}))}),Object(U.jsx)(G,{onSortEnd:oe,size:"small",columns:me,pagination:!1,dataSource:v,rowKey:"id",scroll:{y:M}}),Object(U.jsx)(B,{visible:!!H,params:H,onOk:function(){return Y(null)},onCancel:function(){return Y(null)}})]})})),X=n(1008),Q=n.n(X),W=n(1019),$=(n(177),n(63)),ee=n(225),te=n(268),ne=n(379),ae=n(1021);function re(e){var t=e.value,n=e.onChange,a=e.moduleNames,r=e.templateOptions,i=e.templateId,l=Object(c.a)(e,["value","onChange","moduleNames","templateOptions","templateId"]),s=Object(m.useState)(!1),f=Object(b.a)(s,2),p=f[0],j=f[1],O=Object(ae.a)(a);return Object(m.useEffect)((function(){if(t){var e,c,o=t;if(O!==a)o=null===(e=r.find((function(e){return e.value===i})))||void 0===e||null===(c=e.record)||void 0===c?void 0:c.targetPath;var l=Object(q.d)(o,a);n(l);var s=setTimeout(Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne.b.post("/generate/file/exist",{targetPath:l});case 2:t=e.sent,j(t);case 4:case"end":return e.stop()}}),e)}))),300);return function(){return clearTimeout(s)}}}),[t,a,n,O,r,i]),Object(U.jsxs)("div",{children:[Object(U.jsx)($.a,Object(o.a)({value:t,onChange:n},l)),Object(U.jsx)("span",{style:{marginLeft:4},children:p?Object(U.jsx)(ee.a,{style:{color:"orange"}}):Object(U.jsx)(te.a,{style:{color:"green"}})})]})}t.default=Object(v.a)({path:"/",title:"\u9996\u9875"})((function(e){var t=Object(m.useState)([]),n=Object(b.a)(t,2),a=n[0],s=n[1],p=Object(m.useState)([]),v=Object(b.a)(p,2),w=v[0],y=v[1],k=Object(m.useState)({}),_=Object(b.a)(k,2),C=_[0],P=_[1],I=Object(m.useState)({}),N=Object(b.a)(I,2),S=N[0],T=N[1],q=f.a.useForm(),E=Object(b.a)(q,1)[0],F=Object(m.useCallback)(function(){var t=Object(d.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ajax.get("/db/tables",{dbUrl:n});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.ajax]),A=Object(m.useCallback)(function(){var t=Object(d.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ajax.get("/moduleNames/".concat(n));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.ajax]),L=Object(m.useCallback)(Object(d.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ajax.get("/templates");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),[e.ajax]),V=Object(W.a)((function(){return T({})}),{wait:300}).run,z=Object(W.a)(function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t.target.value,e.next=4,F(a);case 4:r=e.sent,n=r.map((function(e){return{value:e.name,label:e.name}})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),n=[];case 11:s(n);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),{wait:300}).run,K=Object(W.a)(function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(t);case 2:n=e.sent,P(n),E.setFieldsValue({moduleName:n["module-name"]}),V();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{wait:300}).run,M=Object(W.a)(function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.value){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,A(n);case 5:a=e.sent,P(a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{wait:300}).run,R=Object(m.useCallback)((function(e,t){var n=w.find((function(e){return e.value===t})).record,a=n.targetPath,r=n.options,i=E.getFieldValue("files"),c=E.getFieldValue(["files",e]);c.targetPath=a,c.options=Object(l.a)(r),i[e]=c,E.setFieldsValue({files:Object(l.a)(i)}),V()}),[w,E,V]),D=Object(m.useRef)(0),B=Object(m.useCallback)((function(){clearTimeout(D.current),D.current=setTimeout((function(){var e=E.getFieldsValue(),t=e.dbUrl,n=e.files;h.N.local.setItem("files",n),h.N.local.setItem("dbUrl",t)}),500)}),[E]);return Object(m.useEffect)((function(){Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:t=e.sent,n=t.map((function(e){return{record:e,value:e.id,label:e.name}})),y(n);case 5:case"end":return e.stop()}}),e)})))()}),[L]),Object(m.useEffect)((function(){Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.N.local.getItem("dbUrl")){e.next=3;break}return e.abrupt("return");case 3:return E.setFieldsValue({dbUrl:t}),e.next=6,z({target:{value:t}});case 6:case"end":return e.stop()}}),e)})))()}),[E,z]),Object(m.useEffect)((function(){if(null!==w&&void 0!==w&&w.length){var e=h.N.local.getItem("files");if(!e){var t=w[0].record;e=[{templateId:t.id,targetPath:t.targetPath,options:Object(l.a)(t.options)}]}var n=e.map((function(e){var t,n=null===(t=w.find((function(t){return t.value===e.templateId})))||void 0===t?void 0:t.record;return n?Object(o.a)(Object(o.a)({},e),n):null})).filter(Boolean);null!==n&&void 0!==n&&n.length&&E.setFieldsValue({files:n})}}),[E,w]),Object(U.jsx)(h.m,{className:j()(Q.a.root),children:Object(U.jsxs)(f.a,{style:{marginBottom:8},form:E,layout:"inline",initialValues:{files:[{}]},onValuesChange:B,onChange:V,className:j()(Q.a.query),children:[Object(U.jsx)(h.e,{labelCol:{flex:"100px"},style:{width:300},align:"right",label:"\u6570\u636e\u5e93",name:"dbUrl",placeholder:"mysql://username:password@host:port/database",onChange:z,tooltip:"\u652f\u6301mysql\u3001oracle"}),Object(U.jsx)(h.e,{labelCol:{flex:"100px"},style:{width:308},type:"select",showSearch:!0,label:"\u6570\u636e\u5e93\u8868",name:"tableName",onChange:K,options:a}),Object(U.jsx)(h.e,{labelCol:{flex:"91px"},style:{width:200},label:"\u6a21\u5757\u540d",name:"moduleName",placeholder:"\u6bd4\u5982\uff1auser-center",onChange:M,required:!0}),Object(U.jsx)("div",{style:{width:"100%",marginTop:8},children:Object(U.jsx)(f.a.List,{name:"files",children:function(e,t){var n=t.add,a=t.remove;return Object(U.jsx)(U.Fragment,{children:e.map((function(t,s){var u,d=t.key,f=t.name,b=(t.isListField,Object(c.a)(t,["key","name","isListField"])),p=0===s,m=s+1,v=m;p&&(v="\u6587\u4ef6".concat(m));var y=E.getFieldValue(["files",f,"templateId"]),k=null===(u=w.find((function(e){return e.value===y})))||void 0===u?void 0:u.record,_=(null===k||void 0===k?void 0:k.options)||[];return Object(U.jsxs)("div",{className:j()(Q.a.fileRow),children:[Object(U.jsxs)(r.b,{className:j()(Q.a.fileOperator),children:[Object(U.jsx)(i.a,{danger:!0,icon:Object(U.jsx)(O.a,{}),type:"link",disabled:1===e.length,onClick:function(){a(f),V()},className:j()(Q.a.fileMinus)}),p&&e.length<w.length&&Object(U.jsx)(i.a,{type:"link",icon:Object(U.jsx)(x.a,{}),onClick:function(){var e,t=E.getFieldValue("files"),a=(null===(e=w.find((function(e){return!t.find((function(t){return t.templateId===e.value}))})))||void 0===e?void 0:e.record)||{},r=a.id,i=a.targetPath,c=a.options;n({templateId:r,targetPath:i,options:Object(l.a)(c)}),V()},className:j()(Q.a.filePlus)})]}),Object(U.jsx)(h.e,{noStyle:!0,shouldUpdate:function(e,t){var n,a;return(null===e||void 0===e||null===(n=e.files)||void 0===n?void 0:n.length)!==(null===t||void 0===t||null===(a=t.files)||void 0===a?void 0:a.length)},children:function(e){var t=(0,e.getFieldValue)("files"),n=w.filter((function(e){return y===e.value||!t.find((function(t){return t.templateId===e.value}))}));return Object(U.jsx)("div",{style:{width:318},children:Object(U.jsx)(h.e,Object(o.a)(Object(o.a)({},b),{},{labelCol:{flex:"100px",style:{userSelect:"none"}},style:{width:200},label:v,name:[f,"templateId"],rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6a21\u677f\u6587\u4ef6\uff01"}],options:n,placeholder:"\u8bf7\u9009\u62e9\u6a21\u677f",onChange:function(e){return R(f,e)}}))})}}),Object(U.jsx)(h.e,Object(o.a)(Object(o.a)({},b),{},{label:"\u76ee\u6807\u4f4d\u7f6e",name:[f,"targetPath"],rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u76ee\u6807\u6587\u4ef6\u4f4d\u7f6e\uff01"},{validator:function(e,t){return t&&E.getFieldValue("files").filter((function(e){return e.targetPath===t})).length>1?Promise.reject("\u4e0d\u80fd\u4f7f\u7528\u76f8\u540c\u7684\u76ee\u6807\u6587\u4ef6\uff01\u8bf7\u4fee\u6539"):Promise.resolve()}}],children:Object(U.jsx)(re,{style:{width:400},moduleNames:C,templateId:E.getFieldValue(["files",f,"templateId"]),templateOptions:w,placeholder:"\u8bf7\u8f93\u5165\u76ee\u6807\u6587\u4ef6\u4f4d\u7f6e"})})),Object(U.jsx)(h.e,Object(o.a)(Object(o.a)({},b),{},{name:[f,"options"],children:Object(U.jsx)(g.f,{options:_})}))]},d)}))})}})}),Object(U.jsx)(Y,{refreshTable:S,form:E,templateOptions:w})]})})}))}}]);