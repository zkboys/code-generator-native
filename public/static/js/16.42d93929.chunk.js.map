{"version":3,"sources":["pages/department-user/index2.jsx","pages/department-user/EditModal.jsx"],"names":["config","path","props","useState","loading","setLoading","pageNum","setPageNum","pageSize","setPageSize","dataSource","setDataSource","total","setTotal","record","setRecord","visible","setVisible","selectedRowKeys","setSelectedRowKeys","uploading","setUploading","useForm","form","columns","title","dataIndex","width","render","value","id","name","items","label","onClick","color","confirm","onConfirm","handleDelete","handleSearch","useCallback","a","options","validateFields","values","params","ajax","get","res","content","totalElements","handleAdd","handleBatchDelete","length","info","del","ids","successTip","handleImport","file","status","success","message","duration","error","handleExport","download","useEffect","layout","onFinish","wrapperCol","style","type","htmlType","danger","accept","action","showUploadList","headers","onChange","ghost","serialNumber","fitHeight","rowKey","rowSelection","onPageNumChange","onPageSizeChange","isEdit","onOk","onCancel","modal","top","handleSubmit","put","post","setFieldsValue","labelCol","flex","okText","okHtmlType","cancelText","resetFields","hidden","span","maxLength"],"mappings":"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","file":"static/js/16.42d93929.chunk.js","sourcesContent":["import {useCallback, useState, useEffect} from 'react';\nimport {Button, Form, Space, Modal, Upload, notification} from 'antd';\nimport {PageContent, QueryBar, FormItem, Table, Pagination, Operator} from '@ra-lib/admin';\nimport config from 'src/commons/config-hoc';\nimport EditModal from './EditModal';\n\nexport default config({\n    path: '/department_users2',\n})(function DepartmentUserList(props) {\n    const [loading, setLoading] = useState(false);\n    const [pageNum, setPageNum] = useState(1);\n    const [pageSize, setPageSize] = useState(20);\n    const [dataSource, setDataSource] = useState([]);\n    const [total, setTotal] = useState(0);\n    const [record, setRecord] = useState(null);\n    const [visible, setVisible] = useState(false);\n    const [selectedRowKeys, setSelectedRowKeys] = useState([]);\n    const [uploading, setUploading] = useState(false);\n    const [form] = Form.useForm();\n\n    let columns = [\n        { title: '角色名称', dataIndex: 'name' },\n        { title: '启用', dataIndex: 'enabled' },\n        { title: '备注', dataIndex: 'remark' },\n        {\n            title: '操作',\n            dataIndex: 'operator',\n            width: 100,\n            render: (value, record) => {\n                const { id, name } = record;\n                const items = [\n                    {\n                        label: '编辑',\n                        onClick: () => setRecord(record) || setVisible(true),\n                    },\n                    {\n                        label: '删除',\n                        color: 'red',\n                        confirm: {\n                            title: `您确定删除「${name}」吗？`,\n                            onConfirm: () => handleDelete(id),\n                        },\n                    },\n                ];\n                return <Operator items={items}/>;\n            },\n        },\n    ];\n\n    // 查询\n    const handleSearch = useCallback(async (options = {}) => {\n        const values = await form.validateFields();\n        const params = {\n            ...values,\n            pageNum: options.pageNum || pageNum,\n            pageSize: options.pageSize || pageSize,\n        };\n        const res = await props.ajax.get('/department_users', params, { setLoading });\n        const dataSource = res?.content || [{ id: 1 }, { id: 2 }];\n        const total = res?.totalElements || 0;\n        setDataSource(dataSource);\n        setTotal(total);\n    }, [form, pageNum, pageSize, props.ajax]);\n\n    // 添加\n    const handleAdd = useCallback(() => {\n        setRecord(null);\n        setVisible(true);\n    }, []);\n\n    // 批量删除\n    const handleBatchDelete = useCallback(async () => {\n        if (!selectedRowKeys?.length) return Modal.info({ title: '温馨提示', content: '请选择要删除的数据！' });\n        await props.ajax.del('/department_users', { ids: selectedRowKeys }, { setLoading, successTip: '删除成功！' });\n        await handleSearch();\n    }, [handleSearch, props.ajax, selectedRowKeys]);\n\n    // 导入\n    const handleImport = useCallback(async (info) => {\n        if (info.file.status === 'uploading') setUploading(true);\n        if (info.file.status === 'done') {\n            setUploading(false);\n            notification.success({\n                message: '导入成功！',\n                duration: 2,\n            });\n            await handleSearch();\n        }\n        if (info.file.status === 'error') {\n            setUploading(false);\n            notification.error({\n                message: '导入失败！',\n                duration: 2,\n            });\n        }\n    }, [handleSearch]);\n\n    // 导出\n    const handleExport = useCallback(async () => {\n        const values = await form.validateFields();\n        await props.ajax.download('/department_users/export', values);\n    }, [form, props.ajax]);\n\n    // 删除\n    const handleDelete = useCallback(async (id) => {\n        await props.ajax.del(`/department_users/${id}`, null, { setLoading, successTip: '删除成功！' });\n        await handleSearch();\n    }, [handleSearch, props.ajax]);\n\n    // 初始化查询\n    useEffect(() => {\n        (async () => {\n            await handleSearch({ pageNum: 1 });\n        })();\n        // eslint-disable-next-line\n    }, []);\n\n    const layout = {\n        wrapperCol: { style: { width: 200 } },\n    };\n\n    return (\n        <PageContent loading={loading || uploading}>\n            <QueryBar>\n                <Form\n                    layout=\"inline\"\n                    form={form}\n                    onFinish={async () => {\n                        setPageNum(1);\n                        await handleSearch({ pageNum: 1 });\n                    }}\n                >\n                    <FormItem {...layout} label=\"角色名称\" name=\"name\"/>\n                    <FormItem>\n                        <Space>\n                            <Button type=\"primary\" htmlType=\"submit\">\n                                查询\n                            </Button>\n                            <Button htmlType=\"reset\">\n                                重置\n                            </Button>\n                            <Button type=\"primary\" onClick={handleAdd}>\n                                添加\n                            </Button>\n                            <Button type=\"primary\" danger onClick={handleBatchDelete}>\n                                批量删除\n                            </Button>\n                            <Upload\n                                name=\"file\"\n                                accept=\".xlsx,.xls\"\n                                action=\"/api/department_users/import\"\n                                showUploadList={false}\n                                headers={{}}\n                                onChange={handleImport}\n                            >\n                                <Button type=\"primary\" ghost>\n                                    导入\n                                </Button>\n                            </Upload>\n                            <Button onClick={handleExport}>\n                                导出\n                            </Button>\n                        </Space>\n                    </FormItem>\n                </Form>\n            </QueryBar>\n            <Table\n                serialNumber\n                pageNum={pageNum}\n                pageSize={pageSize}\n                fitHeight\n                dataSource={dataSource}\n                columns={columns}\n                rowKey=\"id\"\n                rowSelection={{\n                    selectedRowKeys,\n                    onChange: selectedRowKeys => setSelectedRowKeys(selectedRowKeys),\n                }}\n            />\n            <Pagination\n                total={total}\n                pageNum={pageNum}\n                pageSize={pageSize}\n                onPageNumChange={async pageNum => {\n                    setPageNum(pageNum);\n                    await handleSearch({ pageNum });\n                }}\n                onPageSizeChange={async (pageSize) => {\n                    setPageNum(1);\n                    setPageSize(pageSize);\n                    await handleSearch({ pageNum: 1, pageSize });\n                }}\n            />\n            <EditModal\n                visible={visible}\n                isEdit={!!record}\n                record={record}\n                onOk={async () => {\n                    setVisible(false);\n                    await handleSearch();\n                }}\n                onCancel={() => setVisible(false)}\n            />\n        </PageContent>\n    );\n});\n","import {useCallback, useState, useEffect} from 'react';\nimport {Form, Row, Col} from 'antd';\nimport {ModalContent, FormItem} from '@ra-lib/admin';\nimport config from 'src/commons/config-hoc';\n\nexport default config({\n    modal: {\n        title: (props) => (props.isEdit ? '编辑' : '创建'),\n        width: '70%',\n        top: 50,\n    },\n})(function DepartmentUserEditModal(props) {\n    const { record, isEdit, onOk } = props;\n    const [loading, setLoading] = useState(false);\n    const [form] = Form.useForm();\n\n    const handleSubmit = useCallback(async (values) => {\n        const params = {\n            ...values,\n        };\n\n        if (isEdit) {\n            await props.ajax.put('/department_users', params, { setLoading, successTip: '修改成功！' });\n        } else {\n            await props.ajax.post('/department_users', params, { setLoading, successTip: '修改成功！' });\n        }\n\n        onOk();\n    }, [isEdit, onOk, props.ajax]);\n\n    // 初始化，查询详情数据\n    useEffect(() => {\n        (async () => {\n            const res = await props.ajax.get('/department_users', { id: record?.id }, [], { setLoading });\n            form.setFieldsValue(res || {});\n        })();\n    }, [form, props.ajax, record?.id]);\n\n    const layout = { labelCol: { flex: '100px' } };\n    return (\n        <Form\n            form={form}\n            onFinish={handleSubmit}\n        >\n            <ModalContent\n                loading={loading}\n                okText=\"保存\"\n                okHtmlType=\"submit\"\n                cancelText=\"重置\"\n                onCancel={() => form.resetFields()}\n            >\n                {isEdit ? <FormItem hidden name=\"id\"/> : null}\n                <Row>\n                    <Col span={12}>\n                        <FormItem\n                            {...layout}\n                            type=\"select\"\n                            label=\"部门\"\n                            name=\"departmentId\"\n                        />        \n                    </Col>\n                    <Col span={12}>\n                        <FormItem\n                            {...layout}\n                            type=\"select\"\n                            label=\"用户\"\n                            name=\"userId\"\n                            maxLength={36}\n                        />        \n                    </Col>\n                    <Col span={12}>\n                        <FormItem\n                            {...layout}\n                            type=\"input\"\n                            label=\"是否是领导\"\n                            name=\"isLeader\"\n                        />        \n                    </Col>\n                    <Col span={12}>\n                        <FormItem\n                            {...layout}\n                            type=\"number\"\n                            label=\"排序\"\n                            name=\"order\"\n                        />        \n                    </Col>\n                </Row>\n            </ModalContent>\n        </Form>\n    );\n});"],"sourceRoot":""}