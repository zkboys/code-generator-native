{"version":3,"sources":["pages/home/field-table/virtual-table.jsx","pages/home/PreviewModal.jsx","pages/home/field-table/index.jsx","pages/home/index.jsx","webpack://front/./src/pages/home/field-table/style.less?eb1c","pages/home/field-table/style.less","webpack://front/./src/pages/home/field-table/virtual-table.less?529c","pages/home/field-table/virtual-table.less","webpack://front/./src/pages/home/style.less?5718","pages/home/style.less"],"names":["Table","TabPane","config","modal","title","width","top","props","params","onCancel","useState","loading","setLoading","files","setFiles","fetchGeneratePreview","useCallback","a","ajax","post","useEffect","res","fitHeight","footer","onClick","type","map","file","id","name","content","tab","scrollBarWidth","getScrollBarWidth","RowElement","SortableElement","children","BodyContainer","SortableContainer","MyTable","columns","scroll","className","onSortEnd","tableWidth","setTableWidth","noWidthColumnCount","filter","length","totalWidth","reduce","prev","mergedColumns","column","handleSortEnd","sortProps","oldIndex","newIndex","onResize","components","body","dataSource","helperClass","s","row","height","y","itemCount","itemSize","rowIndex","index","style","columnIndex","record","value","Array","isArray","dataIndex","key","render","val","cell","text","classNames","root","console","log","dbUrl","tableName","templateOptions","form","setDataSource","rootRef","useRef","useHeight","previewParams","setPreviewParams","activeKey","setActiveKey","dbTypeOptions","setDbTypeOptions","fetchGenerateFiles","fetchCheckFilesExist","fetchDbTypeOptions","get","splice","handleAdd","append","newRecord","uuid","comment","chinese","field","formType","dataType","__isNew","push","unshift","handleDelete","nextDataSource","item","handleKeyDown","e","tabIndex","totalColumn","totalRow","keyCode","ctrlKey","shiftKey","altKey","metaKey","isUp","isRight","isDown","isLeft","cursorPosition","getCursorPosition","target","start","end","nextTabIndex","isAdd","columnStartTabIndex","columnEndTabIndex","setTimeout","nextInput","document","querySelector","focus","select","optionColumns","useMemo","templateId","template","find","shortName","formProps","options","fieldOptions","formColumn","isNewEditFields","others","required","placeholder","elementWidth","_columnIndex","isInputLike","includes","it","label","flat","c","element","rules","message","extraProps","onKeyDown","tabPotions","DATA_TYPE_OPTIONS","FORM_ELEMENT_OPTIONS","mode","VALIDATE_OPTIONS","isOption","tabColumns","tabColumn","items","color","confirm","onConfirm","min","step","Boolean","handleGenerate","preview","info","validateFields","values","moduleName","targetPath","okText","okButtonProps","danger","rewrite","paths","success","p","errorFields","error","handleUpdateLocalTemplates","successTip","errorTip","forEach","col","changed","setFieldsValue","ref","noStyle","shouldUpdate","getFieldValue","Object","entries","tabBarExtraContent","left","marginRight","icon","PlusOutlined","ghost","CodeOutlined","FileDoneOutlined","right","DownloadOutlined","onChange","size","pagination","rowKey","visible","onOk","path","tableOptions","setTableOptions","setTemplateOptions","moduleNames","setModuleNames","useForm","fetchDbTables","fetchModuleNames","fetchTemplates","handleDbUrlChange","storage","local","setItem","tables","handleTableNameChange","handleModuleNameBlur","getFormTypeColumnVisible","types","some","extname","split","pop","handleTemplateChange","handleFormChange","triggerWindowResize","templates","getItem","nextFiles","stringFormat","formItemProps","marginBottom","layout","initialValues","onValuesChange","query","labelCol","flex","align","tooltip","showSearch","onBlur","marginTop","List","fields","add","remove","restField","isListField","isLast","number","fileRow","fileOperator","MinusCircleOutlined","fileMinus","PlusCircleOutlined","filePlus","f","userSelect","validator","_","Promise","resolve","findIndex","findLastIndex","reject","prevValue","curValue","getFieldsValue","api","__esModule","default","module","i","exports","locals","___CSS_LOADER_EXPORT___"],"mappings":"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","file":"static/js/7.51a2a666.chunk.js","sourcesContent":["import React, {useCallback, useState} from 'react';\nimport {FixedSizeList as List} from 'react-window';\nimport ResizeObserver from 'rc-resize-observer';\nimport {SortableContainer, SortableElement} from 'react-sortable-hoc';\nimport classNames from 'classnames';\nimport {getScrollBarWidth} from '@ra-lib/admin';\nimport s from './virtual-table.less';\n\nconst scrollBarWidth = getScrollBarWidth();\n\nconst ROW_HEIGHT = 50;\n\nconst RowElement = SortableElement((props) => props.children);\nconst BodyContainer = SortableContainer(props => props.children);\n\nexport default Table => {\n    return props => {\n        const { columns, scroll, className, onSortEnd } = props;\n        const [tableWidth, setTableWidth] = useState(0);\n\n        // 没有设置宽度的列数量\n        const noWidthColumnCount = columns.filter(({ width }) => !width).length;\n        // 已知设置所有宽度总和\n        const totalWidth = columns.reduce((prev, { width = 0 }) => prev + width, 0);\n\n        // 计算未指定宽度列的宽度\n        const mergedColumns = columns.map((column) => {\n            if (column.width) return column;\n\n            // 平均分配表格的剩余宽度\n            let width = (tableWidth - totalWidth) / noWidthColumnCount;\n\n            return { ...column, width };\n        });\n\n        const handleSortEnd = useCallback((sortProps) => {\n            let { oldIndex, newIndex } = sortProps;\n\n            if (oldIndex === newIndex) return;\n\n            onSortEnd && onSortEnd(sortProps);\n        }, [onSortEnd]);\n\n        const renderVirtualList = (dataSource) => {\n            return (\n                <BodyContainer\n                    onSortEnd={handleSortEnd}\n                    helperClass={s.row}\n                >\n                    <List\n                        height={scroll.y}\n                        itemCount={dataSource.length}\n                        itemSize={ROW_HEIGHT}\n                        width={tableWidth}\n                    >\n                        {({ index: rowIndex, style }) => {\n                            return (\n                                <RowElement index={rowIndex}>\n                                    <div className={s.row} style={style}>\n                                        {mergedColumns.map((column, columnIndex) => {\n                                            const record = dataSource[rowIndex];\n                                            const value = Array.isArray(column.dataIndex)\n                                                ? column.dataIndex.reduce((prev, key) => (prev[key] || {}), record)\n                                                : record[column.dataIndex];\n                                            const render = column.render || ((value) => value);\n                                            const width = columnIndex === columns.length - 1 ? column.width - scrollBarWidth : column.width;\n\n                                            const val = render(value, record, rowIndex);\n\n                                            return (\n                                                <div key={column.key || column.dataIndex} className={s.cell} style={{ width }}>\n                                                    {typeof val === 'string' ? (\n                                                        <div className={s.text} title={val}>\n                                                            {render(value, record, rowIndex)}\n                                                        </div>\n                                                    ) : val}\n                                                </div>\n                                            );\n                                        })}\n                                    </div>\n                                </RowElement>\n                            );\n                        }}\n                    </List>\n                </BodyContainer>\n            );\n        };\n\n        return (\n            <ResizeObserver onResize={({ width }) => setTableWidth(width)}>\n                <Table\n                    {...props}\n                    className={classNames(s.root, className)}\n                    columns={mergedColumns}\n                    components={{ body: renderVirtualList }}\n                />\n            </ResizeObserver>\n        );\n    };\n}\n","import {useCallback, useState, useEffect} from 'react';\nimport {Tabs, Button} from 'antd';\nimport {ModalContent} from '@ra-lib/admin';\nimport config from 'src/commons/config-hoc';\n\nconst { TabPane } = Tabs;\n\nexport default config({\n    modal: {\n        title: null,\n        width: '80%',\n        top: 50,\n    },\n})(function PreviewModal(props) {\n    const { params, onCancel } = props;\n    const [loading, setLoading] = useState(false);\n    const [files, setFiles] = useState([]);\n\n    const fetchGeneratePreview = useCallback(async (params) => {\n        return await props.ajax.post('/generate/preview', params, { setLoading });\n    }, [props.ajax]);\n\n    useEffect(() => {\n        (async () => {\n            const res = await fetchGeneratePreview(params);\n            setFiles(res);\n        })();\n    }, [fetchGeneratePreview, params]);\n\n    return (\n        <ModalContent\n            fitHeight\n            loading={loading}\n            footer={<Button onClick={onCancel}>关闭</Button>}\n        >\n            <Tabs\n                type=\"card\"\n            >\n                {files.map(file => {\n                    const { id, name, content } = file;\n\n                    return (\n                        <TabPane key={id} tab={name}>\n                            {content}\n                        </TabPane>\n                    );\n                })}\n            </Tabs>\n\n        </ModalContent>\n    );\n});\n","import React, { useCallback, useMemo, useState, useRef, useEffect } from 'react';\nimport { Tabs, Table, Button, Space, Modal } from 'antd';\nimport { v4 as uuid } from 'uuid';\nimport { CodeOutlined, FileDoneOutlined, PlusOutlined, DownloadOutlined } from '@ant-design/icons';\nimport { Content, Operator, useHeight, confirm, FormItem } from '@ra-lib/admin';\nimport { OptionsTag } from 'src/components';\nimport { DATA_TYPE_OPTIONS, FORM_ELEMENT_OPTIONS, VALIDATE_OPTIONS } from '../constant';\nimport PreviewModal from '../PreviewModal';\nimport config from 'src/commons/config-hoc';\nimport c from 'classnames';\nimport s from './style.less';\nimport virtualTable from './virtual-table';\nimport { getCursorPosition } from 'src/commons';\n\nconst MyTable = virtualTable((Table));\n\nconst { TabPane } = Tabs;\n\nexport default config()(function FieldTable(props) {\n    console.log('FieldTable render');\n    const {\n        dbUrl,\n        tableName,\n        files,\n        templateOptions,\n        form,\n    } = props;\n\n    const [dataSource, setDataSource] = useState([]);\n    const [loading, setLoading] = useState(false);\n    const rootRef = useRef(null);\n    const [height] = useHeight(rootRef, 125, [files]);\n    const [previewParams, setPreviewParams] = useState(null);\n    const [activeKey, setActiveKey] = useState('type');\n    const [dbTypeOptions, setDbTypeOptions] = useState([]);\n\n    const fetchGenerateFiles = useCallback(async (params) => {\n        return await props.ajax.post('/generate/files', params, { setLoading });\n    }, [props.ajax]);\n\n    const fetchCheckFilesExist = useCallback(async (params) => {\n        return await props.ajax.post('/generate/files/exist', params, { setLoading });\n    }, [props.ajax]);\n\n    const fetchDbTypeOptions = useCallback(async (params) => {\n        return await props.ajax.get('/db/types', params, { setLoading });\n    }, [props.ajax]);\n\n    // 拖拽排序结束\n    const handleSortEnd = useCallback((sortProps) => {\n        let { oldIndex, newIndex } = sortProps;\n        dataSource.splice(newIndex, 0, ...dataSource.splice(oldIndex, 1));\n        setDataSource([...dataSource]);\n    }, [dataSource]);\n\n    // 表格新增一行事件\n    const handleAdd = useCallback((append = false) => {\n        const length = dataSource.length;\n\n        const newRecord = {\n            id: uuid(),\n            comment: `新增列${length + 1}`,\n            chinese: `新增列${length + 1}`,\n            field: `field${length + 1}`,\n            formType: 'input',\n            dataType: 'String',\n            __isNew: true,\n        };\n\n        append ? dataSource.push(newRecord) : dataSource.unshift(newRecord);\n        setDataSource([...dataSource]);\n    }, [dataSource]);\n\n    // 删除行\n    const handleDelete = useCallback((id) => {\n        const nextDataSource = dataSource.filter(item => item.id !== id);\n        setDataSource(nextDataSource);\n    }, [dataSource]);\n\n\n    // 键盘时间，使输入框获取焦点，上、下、左、右、回车\n    const handleKeyDown = useCallback((e, tabIndex, columnIndex, totalColumn, totalRow) => {\n        const { keyCode, ctrlKey, shiftKey, altKey, metaKey } = e;\n\n        if (ctrlKey || shiftKey || altKey || metaKey) return;\n\n        const isUp = keyCode === 38;\n        const isRight = keyCode === 39;\n        const isDown = keyCode === 40 || keyCode === 13;\n        const isLeft = keyCode === 37;\n\n        // 移动光标\n        const cursorPosition = getCursorPosition(e.target);\n        if (isLeft && !cursorPosition.start) return;\n        if (isRight && !cursorPosition.end) return;\n\n        const columnStartTabIndex = columnIndex * totalRow + 1;\n        const columnEndTabIndex = (columnIndex + 1) * totalRow;\n\n        let nextTabIndex;\n        let isAdd;\n\n        if (isUp) {\n            // 到顶了\n            if (tabIndex === columnStartTabIndex) return;\n\n            nextTabIndex = tabIndex - 1;\n        }\n\n        if (isRight) {\n            // 右侧\n            if (columnIndex === totalColumn - 1) {\n                // 右下角\n                if (tabIndex === columnEndTabIndex) {\n                    isAdd = true;\n                    nextTabIndex = totalRow + 1;\n                } else {\n                    // 选中下一行第一个\n                    nextTabIndex = tabIndex - totalRow * columnIndex + 1;\n                }\n            } else {\n                // 选择右侧一个\n                nextTabIndex = tabIndex + totalRow;\n            }\n        }\n\n        if (isDown) {\n            if (tabIndex === columnEndTabIndex) {\n                isAdd = true;\n                nextTabIndex = tabIndex + columnIndex + 1;\n            } else {\n                nextTabIndex = tabIndex + 1;\n            }\n        }\n\n        if (isLeft) {\n            // 左上角\n            if (tabIndex === columnStartTabIndex && columnIndex === 0) return;\n\n            // 左侧第一列继续左移动，选中上一行最后一个\n            if (columnIndex === 0) nextTabIndex = (tabIndex - 1) + totalRow * (totalColumn - 1);\n\n            // 选择前一个\n            if (columnIndex !== 0) nextTabIndex = tabIndex - totalRow;\n        }\n\n        if (isAdd) {\n            handleAdd(true);\n        }\n\n        // 等待新增行渲染\n        setTimeout(() => {\n            const nextInput = document.querySelector(`input[tabindex='${nextTabIndex}']`);\n            if (!nextInput) return;\n            nextInput.focus();\n            nextInput.select();\n        });\n    }, [handleAdd]);\n\n\n    // 选项列\n    const optionColumns = useMemo(() => {\n        return (files || []).filter(item => item.templateId)\n            .map(({ templateId }) => {\n                const template = templateOptions.find(item => item.value === templateId)?.record;\n                const title = template?.shortName;\n                const dataIndex = ['options', template?.id];\n                const options = template?.fieldOptions || [];\n                return {\n                    title,\n                    dataIndex,\n                    formProps: {\n                        type: 'tags',\n                        options,\n                    },\n                };\n            });\n    }, [files, templateOptions]);\n\n\n    // 渲染表格中的表单项\n    // 标记当前未第几列\n    let columnIndex = 0;\n    // 一共多少行\n    const totalRow = dataSource.length;\n\n    const formColumn = useCallback((column) => {\n        if (!column?.formProps?.type) return column;\n\n        // 只有新增一行之后才可以编辑的列\n        const isNewEditFields = [\n            'name',\n            'type',\n            'length',\n            'defaultValue',\n            'isNullable',\n        ];\n        const {\n            title,\n            dataIndex,\n            width,\n            formProps,\n            ...others\n        } = column;\n\n        const { type = 'input', required = false, options = [] } = formProps;\n\n        const placeholder = type === 'select' ? `请选择${title}` : `请输入${title}`;\n        let elementWidth = required ? width - 18 : width - 8;\n        if (type === 'switch') elementWidth = 'auto';\n        if (!elementWidth) elementWidth = '100%';\n        const isInputLike = ['input'].includes(type);\n\n        let _columnIndex;\n        if (isInputLike) {\n            _columnIndex = columnIndex++;\n        }\n\n        return {\n            title,\n            dataIndex,\n            width,\n            ...others,\n            render: (value, record, index) => {\n                const { __isNew } = record;\n                if (isNewEditFields.includes(dataIndex) && !__isNew) {\n                    if (['select', 'switch'].includes(type)) return options?.find(it => it.value === value)?.label || value;\n                    return value;\n                }\n\n                const name = ['dataSource', index, Array.isArray(dataIndex) ? dataIndex : [dataIndex]].flat();\n\n                if (type === 'tags') {\n                    return (\n                        <div className={c(s.element, required && s.required)}>\n                            <FormItem\n                                {...formProps}\n                                name={name}\n                                style={{ width: elementWidth }}\n                                rules={[{ required, message: `${placeholder}!` }]}\n                            >\n                                <OptionsTag\n                                    options={options}\n                                />\n                            </FormItem>\n                        </div>\n                    );\n                }\n\n                const extraProps = {};\n                if (isInputLike) {\n                    extraProps.tabIndex = totalRow * _columnIndex + index + 1;\n                    extraProps.onKeyDown = e => handleKeyDown(e, extraProps.tabIndex, _columnIndex, columnIndex, totalRow);\n                }\n\n                return (\n                    <div className={c(s.element, required && s.required)}>\n                        <FormItem\n                            {...formProps}\n                            {...extraProps}\n                            name={name}\n                            style={{ width: elementWidth }}\n                            rules={[{ required, message: `${placeholder}!` }]}\n                            placeholder={placeholder}\n                        />\n                    </div>\n                );\n            },\n        };\n    }, [columnIndex, handleKeyDown, totalRow]);\n\n    // Tab 页配置\n    const tabPotions = useMemo(() => {\n        return [\n            {\n                key: 'type', tab: '类型&验证',\n                columns: [\n                    { title: '数据类型', dataIndex: 'dataType', width: 150, formProps: { type: 'select', options: DATA_TYPE_OPTIONS } },\n                    { title: '表单类型', dataIndex: 'formType', width: 150, formProps: { type: 'select', options: FORM_ELEMENT_OPTIONS } },\n                    { title: '校验规则', dataIndex: 'validation', formProps: { type: 'select', mode: 'multiple', options: VALIDATE_OPTIONS } },\n                ],\n            },\n            {\n                key: 'options', tab: '模板选项',\n                columns: [...optionColumns],\n            },\n        ];\n    }, [optionColumns]);\n\n    // 表格列\n    const columns = useMemo(() => {\n        const isOption = activeKey === 'options';\n        const tabColumns = tabPotions\n            .find(item => item.key === activeKey)\n            .columns\n            .map(item => ({ ...item, className: s.tabColumn }));\n        return [\n            {\n                title: '操作', dataIndex: 'operator', width: 60,\n                render: (value, record) => {\n                    const { id, name } = record;\n                    const items = [\n                        {\n                            label: '删除',\n                            color: 'red',\n                            confirm: {\n                                title: `您确定删除\"${name}\"?`,\n                                onConfirm: () => handleDelete(id),\n                                // placement: 'right',\n                            },\n                        },\n                    ];\n                    return <Operator items={items} />;\n                },\n            },\n            { title: '字段', dataIndex: 'name', width: 150, formProps: { type: 'input', required: true } },\n            { title: '备注', dataIndex: 'comment', width: 150, formProps: { type: 'input', required: true } },\n            !isOption && { title: '类型', dataIndex: 'type', width: 150, formProps: { type: 'select', required: true, options: dbTypeOptions } },\n            !isOption && { title: '长度', dataIndex: 'length', width: 85, formProps: { type: 'number', min: 0, step: 1 } },\n            !isOption && { title: '默认值', dataIndex: 'defaultValue', width: 150, formProps: { type: 'input' } },\n            !isOption && { title: '可为空', dataIndex: 'isNullable', width: 60, formProps: { type: 'switch', options: [{ value: true, label: '是' }, { value: false, label: '否' }] } },\n            ...tabColumns,\n        ].filter(Boolean).map(column => formColumn(column));\n    }, [activeKey, dbTypeOptions, handleDelete, formColumn, tabPotions]);\n\n    // 生成代码、代码预览\n    const handleGenerate = useCallback(async (preview = false) => {\n        try {\n            if (!dataSource?.length) return Modal.info({ title: '温馨提示', content: '表格的字段配置不能为空！' });\n\n            const values = await form.validateFields();\n            const { files, moduleName } = values;\n            const params = {\n                moduleName,\n                files,\n                config: dataSource,\n            };\n\n            if (preview) {\n                setPreviewParams(params);\n            } else {\n                // 检测文件是否存在\n                const res = await fetchCheckFilesExist({ files }) || [];\n\n                // 用户选择是否覆盖\n                for (let targetPath of res) {\n                    const file = files.find(it => it.targetPath === targetPath);\n\n                    try {\n                        await confirm({\n                            width: 600,\n                            title: '文件已存在',\n                            content: targetPath,\n                            okText: '覆盖',\n                            okButtonProps: {\n                                danger: true,\n                            },\n                        });\n                        file.rewrite = true;\n                    } catch (e) {\n                        file.rewrite = false;\n                    }\n                }\n\n                const paths = await fetchGenerateFiles(params);\n                if (!paths?.length) return Modal.info({ title: '温馨提示', content: '未生成任何文件！' });\n\n                Modal.success({\n                    width: 600,\n                    title: '生成文件如下',\n                    content: (\n                        <div>\n                            {paths.map(p => <div key={p}>{p}</div>)}\n                        </div>\n                    ),\n                });\n            }\n        } catch (e) {\n            if (e?.errorFields?.length) {\n                return Modal.info({ title: '温馨提示', content: '表单填写有误，请检查后再提交！' });\n            }\n            console.error(e);\n        }\n    }, [form, dataSource, fetchCheckFilesExist, fetchGenerateFiles]);\n\n    // 更新本地模版\n    const handleUpdateLocalTemplates = useCallback(async () => {\n        await confirm('本地同名模版将被覆盖，是否继续？');\n        await props.ajax.get('/templates/local/download', null, { successTip: '更新成功！' });\n    }, [props.ajax]);\n\n    useEffect(() => {\n        (async () => {\n            const dbTypeOptions = await fetchDbTypeOptions({ dbUrl });\n            setDbTypeOptions(dbTypeOptions);\n        })();\n    }, [dbUrl, fetchDbTypeOptions]);\n\n    // 查询表格数据\n    useEffect(() => {\n        (async () => {\n            // 相关参数不存在，清空数据\n            if (!dbUrl || !tableName) return setDataSource([]);\n\n            const dataSource = await props.ajax.get(`/db/tables/${tableName}`, { dbUrl }, { errorTip: false, setLoading });\n            setDataSource(dataSource);\n        })();\n    }, [dbUrl, tableName, props.ajax]);\n\n\n    // 默认文件选项全选\n    useEffect(() => {\n        (async () => {\n            let changed;\n            optionColumns.forEach(col => {\n                const [, templateId] = col.dataIndex;\n                const options = [...col.formProps.options];\n\n                dataSource.forEach(item => {\n                    if (!item.options) item.options = {};\n\n                    if (!item.options[templateId]) {\n                        item.options[templateId] = [...options];\n                        changed = true;\n                    }\n                });\n            });\n\n            setDataSource(changed ? [...dataSource] : dataSource);\n        })();\n    }, [dataSource, optionColumns]);\n\n    // dataSource改变，将数据同步到form中\n    useEffect(() => form.setFieldsValue({ dataSource }), [form, dataSource]);\n\n    return (\n        <Content loading={loading} ref={rootRef} className={s.root}>\n            {/* 表单改变，将数据同步到dataSource中 */}\n            <FormItem noStyle shouldUpdate>\n                {({ getFieldValue }) => {\n                    const formDataSource = getFieldValue('dataSource') || [];\n                    formDataSource.forEach(item => {\n                        const record = dataSource.find(it => it.id === item.id);\n                        if (!record) return;\n                        Object.entries(item).forEach(([key, value]) => {\n                            record[key] = value;\n                        });\n                    });\n                }}\n            </FormItem>\n            <Tabs\n                tabBarExtraContent={{\n                    left: (\n                        <Space style={{ marginRight: 16 }}>\n                            <Button\n                                icon={<PlusOutlined />}\n                                type=\"primary\"\n                                ghost\n                                onClick={() => handleAdd()}\n                            >\n                                添加一行\n                            </Button>\n                            <Button\n                                icon={<CodeOutlined />}\n                                onClick={() => handleGenerate(true)}\n                            >\n                                代码预览\n                            </Button>\n                            <Button\n                                type=\"primary\"\n                                danger\n                                icon={<FileDoneOutlined />}\n                                onClick={() => handleGenerate()}\n                            >\n                                生成文件\n                            </Button>\n                        </Space>\n                    ),\n                    right: (\n                        <Button\n                            icon={<DownloadOutlined />}\n                            onClick={handleUpdateLocalTemplates}\n                        >\n                            更新本地模版\n                        </Button>\n                    ),\n                }}\n                activeKey={activeKey}\n                onChange={setActiveKey}\n            >\n                {tabPotions.map(item => <TabPane key={item.key} tab={item.tab} />)}\n            </Tabs>\n            <MyTable\n                onSortEnd={handleSortEnd}\n                size=\"small\"\n                columns={columns}\n                pagination={false}\n                dataSource={dataSource}\n                rowKey=\"id\"\n                scroll={{ y: height }}\n            />\n            <PreviewModal\n                visible={!!previewParams}\n                params={previewParams}\n                onOk={() => setPreviewParams(null)}\n                onCancel={() => setPreviewParams(null)}\n            />\n        </Content>\n    );\n});\n","import React, {useState, useEffect, useCallback} from 'react';\nimport {Form, Space} from 'antd';\nimport {MinusCircleOutlined, PlusCircleOutlined} from '@ant-design/icons';\nimport {PageContent, FormItem, storage} from '@ra-lib/admin';\nimport config from 'src/commons/config-hoc';\nimport {OptionsTag} from 'src/components';\nimport {stringFormat, triggerWindowResize} from 'src/commons';\nimport FieldTable from './field-table';\nimport s from './style.less';\n\nexport default config({\n    path: '/',\n    title: '首页',\n})(function Home(props) {\n    const [tableOptions, setTableOptions] = useState([]);\n    const [templateOptions, setTemplateOptions] = useState([]);\n    const [moduleNames, setModuleNames] = useState({});\n    const [form] = Form.useForm();\n\n    const fetchDbTables = useCallback(async (dbUrl) => {\n        return await props.ajax.get('/db/tables', { dbUrl }, { errorTip: false });\n    }, [props.ajax]);\n\n    const fetchModuleNames = useCallback(async (name) => {\n        return await props.ajax.get(`/moduleNames/${name}`, null, { errorTip: false });\n    }, [props.ajax]);\n\n    const fetchTemplates = useCallback(async () => {\n        return await props.ajax.get('/templates', null, { errorTip: false });\n    }, [props.ajax]);\n\n    // 数据库连接改变事件\n    const handleDbUrlChange = useCallback(async (e) => {\n        let tableOptions;\n        try {\n            const dbUrl = e.target.value;\n            storage.local.setItem('dbUrl', dbUrl);\n            const tables = await fetchDbTables(dbUrl);\n            tableOptions = tables.map(item => ({ value: item.name, label: item.name }));\n        } catch (e) {\n            tableOptions = [];\n        }\n\n        setTableOptions(tableOptions);\n    }, [fetchDbTables]);\n\n    // 数据库表改变事件\n    const handleTableNameChange = useCallback(async (tableName) => {\n        const moduleNames = await fetchModuleNames(tableName);\n        setModuleNames(moduleNames);\n        form.setFieldsValue({ moduleName: moduleNames['module-name'] });\n    }, [fetchModuleNames, form]);\n\n    // 模块名改变事件\n    const handleModuleNameBlur = useCallback(async (e) => {\n        const moduleName = e.target.value;\n        if (!moduleName) return;\n        const moduleNames = await fetchModuleNames(moduleName);\n        setModuleNames(moduleNames);\n    }, [fetchModuleNames]);\n\n    const getFormTypeColumnVisible = useCallback(() => {\n        const files = form.getFieldValue('files');\n        const types = ['jsx', 'tsx', 'vue', 'vux', 'html'];\n        return files.some(item => {\n            const extname = item.targetPath.split('.').pop();\n            return types.includes(extname);\n        });\n    }, [form]);\n\n    // 模版改变事件\n    const handleTemplateChange = useCallback((name, templateId) => {\n        const record = templateOptions.find(item => item.value === templateId).record;\n        const { targetPath, options } = record;\n\n        const files = form.getFieldValue('files');\n        const file = form.getFieldValue(['files', name]);\n        file.targetPath = targetPath;\n        file.options = [...options];\n        files[name] = file;\n\n        form.setFieldsValue({ files: [...files] });\n\n        // 强制刷新 targetPath\n        setModuleNames({ ...moduleNames });\n    }, [form, templateOptions, moduleNames]);\n\n    // 表单改变事件\n    const handleFormChange = useCallback(() => {\n        //  触发窗口事件，表格高度重新计算\n        triggerWindowResize();\n    }, []);\n\n    // 初始化时，加载模板\n    useEffect(() => {\n        (async () => {\n            const templates = await fetchTemplates();\n            const templateOptions = templates.map(item => ({ record: item, value: item.id, label: item.name }));\n            setTemplateOptions(templateOptions);\n\n            // 默认展示全部模板\n            const files = templates.map(item => ({\n                templateId: item.id,\n                targetPath: item.targetPath,\n                options: [...(item.options || [])],\n            }));\n            form.setFieldsValue({ files });\n\n        })();\n    }, [fetchTemplates, form, getFormTypeColumnVisible]);\n\n    // 从本地同步数据库链接\n    useEffect(() => {\n        (async () => {\n            const dbUrl = storage.local.getItem('dbUrl');\n            if (!dbUrl) return;\n\n            form.setFieldsValue({ dbUrl });\n            await handleDbUrlChange({ target: { value: dbUrl } });\n        })();\n    }, [form, handleDbUrlChange]);\n\n    // 处理模板的目标位置\n    useEffect(() => {\n        const files = form.getFieldValue('files') || [];\n        const nextFiles = files.map(item => {\n            if (item.targetPath) {\n                const record = templateOptions.find(it => it.value === item.templateId).record;\n                item.targetPath = stringFormat(record.targetPath, moduleNames);\n            }\n\n            return { ...item };\n        });\n        form.setFieldsValue({ files: nextFiles });\n    }, [form, moduleNames, templateOptions]);\n\n    const formItemProps = {\n        // size: 'small',\n    };\n\n    console.log('index render');\n    return (\n        <PageContent className={s.root}>\n            <Form\n                className={s.query}\n                style={{ marginBottom: 8 }}\n                form={form}\n                layout=\"inline\"\n                initialValues={{ files: [{}] }}\n                onValuesChange={handleFormChange}\n            >\n                <FormItem\n                    {...formItemProps}\n                    labelCol={{ flex: '100px' }}\n                    style={{ width: 300 }}\n                    align=\"right\"\n                    label=\"数据库\"\n                    name=\"dbUrl\"\n                    placeholder=\"mysql://username:password@host:port/database\"\n                    onChange={handleDbUrlChange}\n                    tooltip=\"支持mysql、oracle\"\n                />\n                <FormItem\n                    {...formItemProps}\n                    labelCol={{ flex: '100px' }}\n                    style={{ width: 308 }}\n                    type=\"select\"\n                    showSearch\n                    label=\"数据库表\"\n                    name=\"tableName\"\n                    onChange={handleTableNameChange}\n                    options={tableOptions}\n                />\n                <FormItem\n                    {...formItemProps}\n                    labelCol={{ flex: '91px' }}\n                    style={{ width: 200 }}\n                    label=\"模块名\"\n                    name=\"moduleName\"\n                    placeholder=\"比如：user-center\"\n                    onBlur={handleModuleNameBlur}\n                    required\n                />\n                <div style={{ width: '100%', marginTop: 8 }}>\n                    <Form.List name=\"files\">\n                        {(fields, { add, remove }) => (\n                            <>\n                                {fields.map(({ key, name, isListField, ...restField }, index) => {\n                                    const isLast = index === fields.length - 1;\n                                    const isFirst = index === 0;\n                                    const number = index + 1;\n                                    let label = number;\n                                    if (isFirst) label = `文件${number}`;\n\n                                    return (\n                                        <div key={key} className={s.fileRow}>\n                                            <Space className={s.fileOperator}>\n                                                {fields?.length > 1 && (\n                                                    <MinusCircleOutlined\n                                                        className={s.fileMinus}\n                                                        onClick={() => remove(name)}\n                                                    />\n                                                )}\n                                                {isLast && (fields.length < templateOptions.length) && (\n                                                    <PlusCircleOutlined\n                                                        className={s.filePlus}\n                                                        onClick={() => add({})}\n                                                    />\n                                                )}\n                                            </Space>\n                                            <FormItem noStyle shouldUpdate>\n                                                {({ getFieldValue }) => {\n                                                    const files = getFieldValue('files');\n                                                    const templateId = getFieldValue(['files', name, 'templateId']);\n                                                    const options = templateOptions.filter(item => {\n                                                        if (templateId === item.value) return true;\n                                                        return !files.find(f => f.templateId === item.value);\n                                                    });\n                                                    return (\n                                                        <div style={{ width: 318 }}>\n                                                            <FormItem\n                                                                {...formItemProps}\n                                                                {...restField}\n                                                                labelCol={{ flex: '100px', style: { userSelect: 'none' } }}\n                                                                style={{ width: 200 }}\n                                                                label={label}\n                                                                name={[name, 'templateId']}\n                                                                required\n                                                                options={options}\n                                                                placeholder=\"请选择模板\"\n                                                                onChange={(id) => handleTemplateChange(name, id)}\n                                                            />\n                                                        </div>\n                                                    );\n                                                }}\n                                            </FormItem>\n                                            <FormItem\n                                                {...formItemProps}\n                                                {...restField}\n                                                style={{ width: 400 }}\n                                                label=\"目标位置\"\n                                                name={[name, 'targetPath']}\n                                                required\n                                                rules={[\n                                                    {\n                                                        validator(_, value) {\n                                                            if (!value) return Promise.resolve();\n                                                            const files = form.getFieldValue('files');\n                                                            const index = files.findIndex(item => item.targetPath === value);\n                                                            const lastIndex = files.findLastIndex(item => item.targetPath === value);\n                                                            if (index !== lastIndex) return Promise.reject('不能使用相同的目标文件！请修改');\n                                                            return Promise.resolve();\n                                                        },\n                                                    },\n                                                ]}\n                                            />\n                                            <FormItem noStyle shouldUpdate>\n                                                {({ getFieldValue }) => {\n                                                    const templateId = getFieldValue(['files', name, 'templateId']);\n                                                    const record = templateOptions.find(item => item.value === templateId)?.record;\n                                                    const options = record?.options || [];\n                                                    return (\n                                                        <FormItem\n                                                            {...formItemProps}\n                                                            {...restField}\n                                                            name={[name, 'options']}\n                                                        >\n                                                            <OptionsTag options={options}/>\n                                                        </FormItem>\n                                                    );\n                                                }}\n                                            </FormItem>\n                                        </div>\n                                    );\n                                })}\n                            </>\n                        )}\n                    </Form.List>\n                </div>\n\n                <FormItem\n                    shouldUpdate={(prevValue, curValue) => {\n                        const fields = ['dbUrl', 'tableName', 'moduleName', 'files'];\n                        return fields.some(field => prevValue?.[field] !== curValue?.[field]);\n                    }}\n                    noStyle\n                >\n                    {({ getFieldsValue }) => {\n                        const { dbUrl, tableName, files } = getFieldsValue();\n                        return (\n                            <FieldTable\n                                form={form}\n                                dbUrl={dbUrl}\n                                tableName={tableName}\n                                files={files}\n                                templateOptions={templateOptions}\n                            />\n                        );\n                    }}\n                </FormItem>\n            </Form>\n        </PageContent>\n    );\n});\n","var api = require(\"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-10-1!../../../../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-10-2!./style.less\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","// Imports\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(true);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".root_22AK4 {\\n  background-color: #fafafa;\\n}\\n.root_22AK4 .front-form-item {\\n  margin: 0 !important;\\n}\\n.root_22AK4 .front-tabs-nav {\\n  margin-bottom: 0;\\n}\\n.root_22AK4 .front-form-item {\\n  margin-bottom: 0;\\n}\\n.root_22AK4 tbody > tr {\\n  cursor: move;\\n}\\n.element_24b-h {\\n  position: relative;\\n  box-sizing: border-box;\\n  width: 100%;\\n}\\n.element_24b-h.required_1cZgn {\\n  padding-left: 10px;\\n}\\n.element_24b-h.required_1cZgn:before {\\n  position: absolute;\\n  display: inline-block;\\n  left: 0;\\n  top: 10px;\\n  color: #ff4d4f;\\n  font-size: 14px;\\n  font-family: SimSun, sans-serif;\\n  line-height: 1;\\n  content: '*';\\n}\\n.tabColumn_ihqDw {\\n  background: rgba(24, 144, 255, 0.05);\\n}\\n.helper_qLOjP {\\n  display: table-row;\\n}\\n.helper_qLOjP td {\\n  border-bottom: 1px solid #f0f0f0;\\n  border-top: 1px solid #f0f0f0;\\n  padding: 8px;\\n  display: table-cell;\\n  vertical-align: center;\\n  background: #fff;\\n  width: 10000px;\\n  border-collapse: collapse;\\n}\\n.helper_qLOjP .front-form-item_2EPyJ {\\n  margin-bottom: 0;\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://src/pages/home/field-table/style.less\",\"webpack://src/theme.less\"],\"names\":[],\"mappings\":\"AAEA;EACI,yBAAA;AAIJ;AALA;EAKY,oBAAA;AAGZ;AARA;EASY,gBAAA;AAEZ;AAXA;EAaY,gBAAA;AACZ;AAdA;EAkBQ,YAAA;AADR;AAKA;EACI,kBAAA;EACA,sBAAA;EACA,WAAA;AAHJ;AAKI;EACI,kBAAA;AAHR;AAMI;EACI,kBAAA;EACA,qBAAA;EACA,OAAA;EACA,SAAA;EACA,cAAA;EACA,eAAA;EACA,+BAAA;EACA,cAAA;EACA,YAAA;AAJR;AAQA;EACI,oCAAA;AANJ;AASA;EACI,kBAAA;AAPJ;AAUA;EACI,gCAAA;EACA,6BAAA;EACA,YAAA;EACA,mBAAA;EACA,sBAAA;EACA,gBAAA;EACA,cAAA;EACA,yBAAA;AARJ;ACtDC;EDkEG,gBAAA;AATJ\",\"sourcesContent\":[\"@import 'src/theme';\\n\\n.root {\\n    background-color: #fafafa;\\n\\n    :global {\\n        .@{ant-prefix}-form-item {\\n            margin: 0 !important;\\n        }\\n\\n        .@{ant-prefix}-tabs-nav {\\n            margin-bottom: 0;\\n        }\\n\\n        .@{ant-prefix}-form-item {\\n            margin-bottom: 0;\\n        }\\n    }\\n\\n    tbody > tr {\\n        cursor: move;\\n    }\\n}\\n\\n.element {\\n    position: relative;\\n    box-sizing: border-box;\\n    width: 100%;\\n\\n    &.required {\\n        padding-left: 10px;\\n    }\\n\\n    &.required:before {\\n        position: absolute;\\n        display: inline-block;\\n        left: 0;\\n        top: 10px;\\n        color: #ff4d4f;\\n        font-size: 14px;\\n        font-family: SimSun, sans-serif;\\n        line-height: 1;\\n        content: '*';\\n    }\\n}\\n\\n.tabColumn {\\n    background: rgba(24, 144, 255, .05);\\n}\\n\\n.helper {\\n    display: table-row;\\n}\\n\\n.helper td {\\n    border-bottom: 1px solid #f0f0f0;\\n    border-top: 1px solid #f0f0f0;\\n    padding: 8px;\\n    display: table-cell;\\n    vertical-align: center;\\n    background: #fff;\\n    width: 10000px;\\n    border-collapse: collapse;\\n}\\n\\n.helper .@{ant-prefix}-form-item {\\n    margin-bottom: 0;\\n}\\n\\n\\n@packageName: front;\",\"// 样式前缀，做微前端，防止各个系统样式冲突时，各个系统修改为不同的值\\n@packageName: ''; // lessLoader 会改为 package.json name属性\\n@ant-prefix: ~'@{packageName}';\\n@ra-lib-prefix: ~'@{packageName}-ra';\\n\\n// 自定义变量\\n//@page-content-margin: 0;\\n//@page-content-padding: 0;\\n//@content-margin: 0px;\\n//@content-padding: 8px;\\n//@layout-z-index: 999;\\n//@layout-transition-duration: 0;\\n\\n// ant 官方变量\\n// https://github.com/ant-design/ant-design/blob/master/components/style/themes/default.less\\n@border-color-base: hsv(0, 0, 85%);\\n@font-size-base: 14px;\\n\\n//@primary-color: #42b983;\\n//@layout-header-background: #42b983;\\n//@menu-dark-inline-submenu-bg: #349368;\\n\\n@primary-color: #1890ff; // 主题色\\n@layout-header-background: #001529; // 头部背景色\\n@menu-dark-inline-submenu-bg: #000c17; // 菜单背景色\\n\\n// 字体颜色\\n@text-color: fade(#000, 65%);\\n@body-background: #f0f2f5;\\n\\n:export {\\n    antPrefix: @ant-prefix;\\n    raLibPrefix: @ra-lib-prefix;\\n    primaryColor: @primary-color;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"antPrefix\": \"front\",\n\t\"raLibPrefix\": \"front-ra\",\n\t\"primaryColor\": \"#1890ff\",\n\t\"root\": \"root_22AK4\",\n\t\"element\": \"element_24b-h\",\n\t\"required\": \"required_1cZgn\",\n\t\"tabColumn\": \"tabColumn_ihqDw\",\n\t\"helper\": \"helper_qLOjP\",\n\t\"front-form-item\": \"front-form-item_2EPyJ\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","var api = require(\"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-10-1!../../../../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-10-2!./virtual-table.less\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","// Imports\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(true);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".root_3H-yq .front-table-container:before,\\n.root_3H-yq .front-table-container:after {\\n  display: none;\\n}\\n.row_OlUvz {\\n  display: flex;\\n  align-items: center;\\n  border-bottom: 1px solid #e8e8e8;\\n  background: #FFF;\\n  box-sizing: border-box;\\n  cursor: move;\\n}\\n.row_OlUvz .front-form-item {\\n  margin: 0 !important;\\n  position: relative;\\n}\\n.row_OlUvz .front-form-item-explain {\\n  position: absolute;\\n  bottom: -21px;\\n  z-index: 10;\\n}\\n.cell_3GMOg {\\n  height: 100%;\\n  display: flex;\\n  align-items: center;\\n  padding: 0 4px;\\n  width: 0;\\n  box-sizing: border-box;\\n}\\n.cell_3GMOg .text_30g6_ {\\n  width: 100%;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  white-space: nowrap;\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://src/pages/home/field-table/virtual-table.less\"],\"names\":[],\"mappings\":\"AAEA;;EAIY,aAAA;AAEZ;AAOA;EACI,aAAA;EACA,mBAAA;EACA,gCAAA;EACA,gBAAA;EACA,sBAAA;EACA,YAAA;AALJ;AADA;EAUY,oBAAA;EACA,kBAAA;AANZ;AALA;EAeY,kBAAA;EACA,aAAA;EACA,WAAA;AAPZ;AAYA;EACI,YAAA;EACA,aAAA;EACA,mBAAA;EACA,cAAA;EACA,QAAA;EACA,sBAAA;AAVJ;AAIA;EASQ,WAAA;EACA,gBAAA;EACA,uBAAA;EACA,mBAAA;AAVR\",\"sourcesContent\":[\"@import 'src/theme';\\n\\n.root {\\n    :global {\\n        .@{ant-prefix}-table-container:before,\\n        .@{ant-prefix}-table-container:after {\\n            display: none;\\n        }\\n\\n        //\\n        //.@{ant-prefix}-table-cell {\\n        //}\\n    }\\n}\\n\\n.row {\\n    display: flex;\\n    align-items: center;\\n    border-bottom: 1px solid #e8e8e8;\\n    background: #FFF;\\n    box-sizing: border-box;\\n    cursor: move;\\n\\n    :global {\\n        .@{ant-prefix}-form-item {\\n            margin: 0 !important;\\n            position: relative;\\n        }\\n\\n        .@{ant-prefix}-form-item-explain {\\n            position: absolute;\\n            bottom: -21px;\\n            z-index: 10;\\n        }\\n    }\\n}\\n\\n.cell {\\n    height: 100%;\\n    display: flex;\\n    align-items: center;\\n    padding: 0 4px;\\n    width: 0;\\n    box-sizing: border-box;\\n\\n    .text {\\n        width: 100%;\\n        overflow: hidden;\\n        text-overflow: ellipsis;\\n        white-space: nowrap;\\n    }\\n}\\n\\n@packageName: front;\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"antPrefix\": \"front\",\n\t\"raLibPrefix\": \"front-ra\",\n\t\"primaryColor\": \"#1890ff\",\n\t\"root\": \"root_3H-yq\",\n\t\"row\": \"row_OlUvz\",\n\t\"cell\": \"cell_3GMOg\",\n\t\"text\": \"text_30g6_\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","var api = require(\"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-10-1!../../../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-10-2!./style.less\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","// Imports\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(true);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".query_39zez .front-form-item {\\n  margin-bottom: 6px;\\n}\\n.query_39zez .front-form-item-explain {\\n  position: absolute;\\n  margin-top: -3px;\\n  z-index: 10;\\n}\\n.fileRow_KjD5F {\\n  display: flex;\\n  align-items: center;\\n  padding-top: 7px;\\n  background: #eee;\\n  position: relative;\\n}\\n.fileMinus_17Owl {\\n  color: red;\\n}\\n.filePlus_2owcT {\\n  color: green;\\n}\\n.fileOperator_DiSbC {\\n  display: flex;\\n  align-items: center;\\n  position: absolute;\\n  left: 10px;\\n  top: -4px;\\n  height: 100%;\\n  z-index: 10;\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://src/pages/home/style.less\"],\"names\":[],\"mappings\":\"AAKA;EAGY,kBAAA;AADZ;AAFA;EAOY,kBAAA;EACA,gBAAA;EACA,WAAA;AAFZ;AAOA;EACI,aAAA;EACA,mBAAA;EACA,gBAAA;EACA,gBAAA;EACA,kBAAA;AALJ;AAQA;EACI,UAAA;AANJ;AASA;EACI,YAAA;AAPJ;AAUA;EACI,aAAA;EACA,mBAAA;EACA,kBAAA;EACA,UAAA;EACA,SAAA;EACA,YAAA;EACA,WAAA;AARJ\",\"sourcesContent\":[\"@import \\\"src/theme.less\\\";\\n\\n.root {\\n}\\n\\n.query {\\n    :global {\\n        .@{ant-prefix}-form-item {\\n            margin-bottom: 6px;\\n        }\\n\\n        .@{ant-prefix}-form-item-explain {\\n            position: absolute;\\n            margin-top: -3px;\\n            z-index: 10;\\n        }\\n    }\\n}\\n\\n.fileRow {\\n    display: flex;\\n    align-items: center;\\n    padding-top: 7px;\\n    background: #eee;\\n    position: relative;\\n}\\n\\n.fileMinus {\\n    color: red;\\n}\\n\\n.filePlus {\\n    color: green;\\n}\\n\\n.fileOperator {\\n    display: flex;\\n    align-items: center;\\n    position: absolute;\\n    left: 10px;\\n    top: -4px;\\n    height: 100%;\\n    z-index: 10;\\n}\\n\\n@packageName: front;\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"antPrefix\": \"front\",\n\t\"raLibPrefix\": \"front-ra\",\n\t\"primaryColor\": \"#1890ff\",\n\t\"query\": \"query_39zez\",\n\t\"fileRow\": \"fileRow_KjD5F\",\n\t\"fileMinus\": \"fileMinus_17Owl\",\n\t\"filePlus\": \"filePlus_2owcT\",\n\t\"fileOperator\": \"fileOperator_DiSbC\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n"],"sourceRoot":""}