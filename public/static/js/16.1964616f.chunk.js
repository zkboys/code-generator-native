(this.webpackJsonp_front=this.webpackJsonp_front||[]).push([[16],{962:function(e,t,a){"use strict";a.r(t);a(323);var n=a(175),r=(a(1018),a(1015)),c=(a(113),a(36)),s=(a(383),a(190)),i=(a(204),a(99)),u=a(38),o=a.n(u),l=a(21),j=a(155),d=(a(322),a(156)),b=a(39),p=a(0),O=a(19),x=a(234),f=(a(973),a(975)),m=(a(974),a(976)),h=a(11),v=Object(x.a)({modal:{title:function(e){return e.isEdit?"\u4fee\u6539":"\u521b\u5efa"},width:"70%",top:50}})((function(e){var t=e.record,a=e.isEdit,n=e.onOk,r=Object(p.useState)(!1),c=Object(b.a)(r,2),s=c[0],i=c[1],u=d.a.useForm(),x=Object(b.a)(u,1)[0],v=Object(p.useCallback)(function(){var t=Object(j.a)(o.a.mark((function t(r){var c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=Object(l.a)({},r),!a){t.next=6;break}return t.next=4,e.ajax.put("/department_users",c,{setLoading:i,successTip:"\u4fee\u6539\u6210\u529f\uff01"});case 4:t.next=8;break;case 6:return t.next=8,e.ajax.post("/department_users",c,{setLoading:i,successTip:"\u521b\u5efa\u6210\u529f\uff01"});case 8:n();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[a,n,e.ajax]);Object(p.useEffect)((function(){Object(j.a)(o.a.mark((function a(){var n;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.ajax.get("/department_users",{id:null===t||void 0===t?void 0:t.id},[],{setLoading:i});case 2:n=a.sent,x.setFieldsValue(n||{});case 4:case"end":return a.stop()}}),a)})))()}),[x,e.ajax,null===t||void 0===t?void 0:t.id]);var g={labelCol:{flex:"100px"}};return Object(h.jsx)(d.a,{form:x,onFinish:v,children:Object(h.jsxs)(O.k,{loading:s,okText:"\u4fdd\u5b58",okHtmlType:"submit",cancelText:"\u91cd\u7f6e",onCancel:function(){return x.resetFields()},children:[a?Object(h.jsx)(O.e,{hidden:!0,name:"id"}):null,Object(h.jsxs)(f.a,{children:[Object(h.jsx)(m.a,{span:12,children:Object(h.jsx)(O.e,Object(l.a)(Object(l.a)({},g),{},{type:"input",label:"\u7528\u6237",name:"userId",required:!0,maxLength:36,rules:[{pattern:/^[1-9][0-9]{4,9}$/,message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684qq\u53f7\uff01"},{pattern:/(^\d{15}$)|(^\d{17}([0-9]|X|x)$)/,message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u8eab\u4efd\u8bc1\u53f7\uff01"}]}))}),Object(h.jsx)(m.a,{span:12,children:Object(h.jsx)(O.e,Object(l.a)(Object(l.a)({},g),{},{type:"input",label:"\u90e8\u95e8",name:"departmentId"}))}),Object(h.jsx)(m.a,{span:12,children:Object(h.jsx)(O.e,Object(l.a)(Object(l.a)({},g),{},{type:"input",label:"\u662f\u5426\u662f\u9886\u5bfc",name:"isLeader"}))}),Object(h.jsx)(m.a,{span:12,children:Object(h.jsx)(O.e,Object(l.a)(Object(l.a)({},g),{},{type:"number",label:"\u6392\u5e8f",name:"order"}))})]})]})})})),g=(a(996),a(1017)),k=Object(x.a)({modal:{title:"\u8be6\u60c5",width:"70%",top:50}})((function(e){var t,a,n,r,s=e.record,i=e.onCancel,u=Object(p.useState)(!1),l=Object(b.a)(u,2),d=l[0],x=l[1],f=Object(p.useState)({}),m=Object(b.a)(f,2),v=m[0],k=m[1];return Object(p.useEffect)((function(){Object(j.a)(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ajax.get("/department_users",{id:null===s||void 0===s?void 0:s.id},[],{setLoading:x});case 2:a=t.sent,k(a||{});case 4:case"end":return t.stop()}}),t)})))()}),[e.ajax,null===s||void 0===s?void 0:s.id]),Object(h.jsx)(O.k,{bodyStyle:{padding:0},loading:d,footer:Object(h.jsx)(c.a,{onClick:i,children:"\u5173\u95ed"}),children:Object(h.jsxs)(g.b,{bordered:!0,size:"small",children:[Object(h.jsx)(g.b.Item,{label:"\u7528\u6237",children:null!==(t=v.userId)&&void 0!==t?t:"-"}),Object(h.jsx)(g.b.Item,{label:"\u90e8\u95e8",children:null!==(a=v.departmentId)&&void 0!==a?a:"-"}),Object(h.jsx)(g.b.Item,{label:"\u662f\u5426\u662f\u9886\u5bfc",children:null!==(n=v.isLeader)&&void 0!==n?n:"-"}),Object(h.jsx)(g.b.Item,{label:"\u6392\u5e8f",children:null!==(r=v.order)&&void 0!==r?r:"-"})]})})}));t.default=Object(x.a)({path:"/department_users"})((function(e){var t=Object(p.useState)(!1),a=Object(b.a)(t,2),u=a[0],x=a[1],f=Object(p.useState)(1),m=Object(b.a)(f,2),g=m[0],w=m[1],y=Object(p.useState)(20),C=Object(b.a)(y,2),S=C[0],I=C[1],L=Object(p.useState)([]),_=Object(b.a)(L,2),N=_[0],T=_[1],F=Object(p.useState)(0),z=Object(b.a)(F,2),E=z[0],q=z[1],$=Object(p.useState)(null),H=Object(b.a)($,2),J=H[0],K=H[1],P=Object(p.useState)(!1),R=Object(b.a)(P,2),U=R[0],V=R[1],X=Object(p.useState)(!1),A=Object(b.a)(X,2),B=A[0],D=A[1],G=Object(p.useState)([]),M=Object(b.a)(G,2),Q=M[0],W=M[1],Y=Object(p.useState)(!1),Z=Object(b.a)(Y,2),ee=Z[0],te=Z[1],ae=d.a.useForm(),ne=Object(b.a)(ae,1)[0],re=[{title:"\u7528\u6237",dataIndex:"userId"},{title:"\u90e8\u95e8",dataIndex:"departmentId"},{title:"\u662f\u5426\u662f\u9886\u5bfc",dataIndex:"isLeader"},{title:"\u6392\u5e8f",dataIndex:"order"},{title:"\u64cd\u4f5c",dataIndex:"operator",width:150,render:function(e,t){var a=t.id,n=t.name,r=[{label:"\u7f16\u8f91",onClick:function(){K(t),V(!0)}},{label:"\u8be6\u60c5",onClick:function(){K(t),D(!0)}},{label:"\u5220\u9664",color:"red",confirm:{title:"\u60a8\u786e\u5b9a\u5220\u9664\u300c".concat(n,"\u300d\u5417\uff1f"),onConfirm:function(){return le(a)}}}];return Object(h.jsx)(O.l,{items:r})}}],ce=Object(p.useCallback)(Object(j.a)(o.a.mark((function t(){var a,n,r,c,s,i,u=arguments;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=u.length>0&&void 0!==u[0]?u[0]:{},t.next=3,ne.validateFields();case 3:return n=t.sent,r=Object(l.a)(Object(l.a)({},n),{},{pageNum:a.pageNum||g,pageSize:a.pageSize||S}),t.next=7,e.ajax.get("/department_users",r,{setLoading:x});case 7:c=t.sent,s=(null===c||void 0===c?void 0:c.content)||[{id:1},{id:2}],i=(null===c||void 0===c?void 0:c.totalElements)||0,T(s),q(i);case 12:case"end":return t.stop()}}),t)}))),[ne,g,S,e.ajax]),se=Object(p.useCallback)((function(){K(null),V(!0)}),[]),ie=Object(p.useCallback)(Object(j.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==Q&&void 0!==Q&&Q.length){t.next=2;break}return t.abrupt("return",i.a.info({title:"\u6e29\u99a8\u63d0\u793a",content:"\u8bf7\u9009\u62e9\u8981\u5220\u9664\u7684\u6570\u636e\uff01"}));case 2:return t.next=4,e.ajax.del("/department_users",{ids:Q},{setLoading:x,successTip:"\u5220\u9664\u6210\u529f\uff01"});case 4:return t.next=6,ce();case 6:case"end":return t.stop()}}),t)}))),[ce,e.ajax,Q]),ue=Object(p.useCallback)(function(){var e=Object(j.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("uploading"===t.file.status&&te(!0),"done"!==t.file.status){e.next=6;break}return te(!1),s.a.success({message:"\u5bfc\u5165\u6210\u529f\uff01",duration:2}),e.next=6,ce();case 6:"error"===t.file.status&&(te(!1),s.a.error({message:"\u5bfc\u5165\u5931\u8d25\uff01",duration:2}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[ce]),oe=Object(p.useCallback)(Object(j.a)(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ne.validateFields();case 2:return a=t.sent,t.next=5,e.ajax.download("/department_users/export",a);case 5:case"end":return t.stop()}}),t)}))),[ne,e.ajax]),le=Object(p.useCallback)(function(){var t=Object(j.a)(o.a.mark((function t(a){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ajax.del("/department_users/".concat(a),null,{setLoading:x,successTip:"\u5220\u9664\u6210\u529f\uff01"});case 2:return t.next=4,ce();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[ce,e.ajax]);Object(p.useEffect)((function(){Object(j.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce({pageNum:1});case 2:case"end":return e.stop()}}),e)})))()}),[]);var je={wrapperCol:{style:{width:200}}};return Object(h.jsxs)(O.m,{loading:u||ee,children:[Object(h.jsx)(O.o,{children:Object(h.jsxs)(d.a,{layout:"inline",form:ne,onFinish:Object(j.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(1),e.next=3,ce({pageNum:1});case 3:case"end":return e.stop()}}),e)}))),children:[Object(h.jsx)(O.e,Object(l.a)(Object(l.a)({},je),{},{type:"input",label:"\u7528\u6237",name:"userId"})),Object(h.jsx)(O.e,Object(l.a)(Object(l.a)({},je),{},{type:"input",label:"\u90e8\u95e8",name:"departmentId"})),Object(h.jsx)(O.e,Object(l.a)(Object(l.a)({},je),{},{type:"input",label:"\u662f\u5426\u662f\u9886\u5bfc",name:"isLeader"})),Object(h.jsx)(O.e,Object(l.a)(Object(l.a)({},je),{},{type:"number",label:"\u6392\u5e8f",name:"order"})),Object(h.jsx)(O.e,{children:Object(h.jsxs)(n.b,{children:[Object(h.jsx)(c.a,{type:"primary",htmlType:"submit",children:"\u67e5\u8be2"}),Object(h.jsx)(c.a,{htmlType:"reset",children:"\u91cd\u7f6e"}),Object(h.jsx)(c.a,{type:"primary",onClick:se,children:"\u6dfb\u52a0"}),Object(h.jsx)(c.a,{type:"primary",danger:!0,onClick:ie,children:"\u6279\u91cf\u5220\u9664"}),Object(h.jsx)(r.a,{name:"file",accept:".xlsx,.xls",action:"/api/department_users/import",showUploadList:!1,headers:{},onChange:ue,children:Object(h.jsx)(c.a,{type:"primary",ghost:!0,children:"\u5bfc\u5165"})}),Object(h.jsx)(c.a,{onClick:oe,children:"\u5bfc\u51fa"})]})})]})}),Object(h.jsx)(O.p,{serialNumber:!0,pageNum:g,pageSize:S,fitHeight:!0,dataSource:N,columns:re,rowKey:"id",rowSelection:{selectedRowKeys:Q,onChange:function(e){return W(e)}}}),Object(h.jsx)(O.n,{total:E,pageNum:g,pageSize:S,onPageNumChange:function(){var e=Object(j.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(t),e.next=3,ce({pageNum:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onPageSizeChange:function(){var e=Object(j.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(1),I(t),e.next=4,ce({pageNum:1,pageSize:t});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),Object(h.jsx)(v,{visible:U,isEdit:!!J,record:J,onOk:Object(j.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return V(!1),e.next=3,ce();case 3:case"end":return e.stop()}}),e)}))),onCancel:function(){return V(!1)}}),Object(h.jsx)(k,{visible:B,record:J,onCancel:function(){return D(!1)}})]})}))}}]);