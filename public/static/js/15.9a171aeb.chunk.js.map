{"version":3,"sources":["pages/department-user/index.jsx","../node_modules/antd/es/row/style/index.js","../node_modules/antd/es/col/style/index.js","../node_modules/antd/es/row/index.js","../node_modules/antd/es/col/index.js","pages/department-user/EditModal.jsx"],"names":["config","path","props","useState","loading","setLoading","pageNum","setPageNum","pageSize","setPageSize","dataSource","setDataSource","total","setTotal","record","setRecord","visible","setVisible","useForm","form","columns","title","dataIndex","width","render","value","id","name","items","label","onClick","color","confirm","onConfirm","handleDelete","handleSearch","useCallback","a","options","validateFields","values","params","ajax","get","res","content","totalElements","handleAdd","del","successTip","useEffect","layout","wrapperCol","style","onFinish","type","htmlType","fitHeight","rowKey","onPageNumChange","onPageSizeChange","isEdit","onOk","onCancel","Row","Col","modal","top","handleSubmit","put","post","setFieldsValue","labelCol","flex","okText","okHtmlType","cancelText","resetFields","hidden","span","maxLength"],"mappings":"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","file":"static/js/15.9a171aeb.chunk.js","sourcesContent":["import {useCallback, useState, useEffect} from 'react';\nimport {Button, Form, Space} from 'antd';\nimport {PageContent, QueryBar, FormItem, Table, Pagination, Operator} from '@ra-lib/admin';\nimport config from 'src/commons/config-hoc';\nimport EditModal from './EditModal';\n\nexport default config({\n    path: '/department_users',\n})(function DepartmentUserList(props) {\n    const [loading, setLoading] = useState(false);\n    const [pageNum, setPageNum] = useState(1);\n    const [pageSize, setPageSize] = useState(20);\n    const [dataSource, setDataSource] = useState([]);\n    const [total, setTotal] = useState(0);\n    const [record, setRecord] = useState(null);\n    const [visible, setVisible] = useState(false);\n    const [form] = Form.useForm();\n\n    let columns = [\n        { title: '部门', dataIndex: 'departmentId' },\n        { title: '用户', dataIndex: 'userId' },\n        { title: '是否是领导', dataIndex: 'isLeader' },\n        { title: '排序', dataIndex: 'order' },\n        {\n            title: '操作',\n            dataIndex: 'operator',\n            width: 100,\n            render: (value, record) => {\n                const { id, name } = record;\n                const items = [\n                    {\n                        label: '编辑',\n                        onClick: () => {\n                            setRecord(record);\n                            setVisible(true);\n                        },\n                    },\n                    {\n                        label: '删除',\n                        color: 'red',\n                        confirm: {\n                            title: `您确定删除「${name}」吗？`,\n                            onConfirm: () => handleDelete(id),\n                        },\n                    },\n                ];\n                return <Operator items={items}/>;\n            },\n        },\n    ];\n\n    // 查询\n    const handleSearch = useCallback(async (options = {}) => {\n        const values = await form.validateFields();\n        const params = {\n            ...values,\n            pageNum: options.pageNum || pageNum,\n            pageSize: options.pageSize || pageSize,\n        };\n        const res = await props.ajax.get('/department_users', params, { setLoading });\n        const dataSource = res?.content || [{ id: 1 }, { id: 2 }];\n        const total = res?.totalElements || 0;\n        setDataSource(dataSource);\n        setTotal(total);\n    }, [form, pageNum, pageSize, props.ajax]);\n\n    // 添加\n    const handleAdd = useCallback(() => {\n        setRecord(null);\n        setVisible(true);\n    }, []);\n\n    // 删除\n    const handleDelete = useCallback(async (id) => {\n        await props.ajax.del(`/department_users/${id}`, null, { setLoading, successTip: '删除成功！' });\n        await handleSearch();\n    }, [handleSearch, props.ajax]);\n\n    // 初始化查询\n    useEffect(() => {\n        (async () => {\n            await handleSearch({ pageNum: 1 });\n        })();\n        // eslint-disable-next-line\n    }, []);\n\n    const layout = {\n        wrapperCol: { style: { width: 200 } },\n    };\n\n    return (\n        <PageContent loading={loading}>\n            <QueryBar>\n                <Form\n                    layout=\"inline\"\n                    form={form}\n                    onFinish={async () => {\n                        setPageNum(1);\n                        await handleSearch({ pageNum: 1 });\n                    }}\n                >\n                    <FormItem {...layout} type=\"select\" label=\"部门\" name=\"departmentId\"/>\n                    <FormItem {...layout} type=\"select\" label=\"用户\" name=\"userId\"/>\n                    <FormItem>\n                        <Space>\n                            <Button type=\"primary\" htmlType=\"submit\">\n                                查询\n                            </Button>\n                            <Button htmlType=\"reset\">\n                                重置\n                            </Button>\n                            <Button type=\"primary\" onClick={handleAdd}>\n                                添加\n                            </Button>\n                        </Space>\n                    </FormItem>\n                </Form>\n            </QueryBar>\n            <Table\n                pageNum={pageNum}\n                pageSize={pageSize}\n                fitHeight\n                dataSource={dataSource}\n                columns={columns}\n                rowKey=\"id\"\n            />\n            <Pagination\n                total={total}\n                pageNum={pageNum}\n                pageSize={pageSize}\n                onPageNumChange={async pageNum => {\n                    setPageNum(pageNum);\n                    await handleSearch({ pageNum });\n                }}\n                onPageSizeChange={async (pageSize) => {\n                    setPageNum(1);\n                    setPageSize(pageSize);\n                    await handleSearch({ pageNum: 1, pageSize });\n                }}\n            />\n            <EditModal\n                visible={visible}\n                isEdit={!!record}\n                record={record}\n                onOk={async () => {\n                    setVisible(false);\n                    await handleSearch();\n                }}\n                onCancel={() => setVisible(false)}\n            />\n        </PageContent>\n    );\n});\n","import '../../style/index.less'; // style dependencies\n// deps-lint-skip: grid\n\nimport '../../grid/style';","import '../../style/index.less'; // style dependencies\n// deps-lint-skip: grid\n\nimport '../../grid/style';","import { Row } from '../grid';\nexport default Row;","import { Col } from '../grid';\nexport default Col;","import {useCallback, useState, useEffect} from 'react';\nimport {Form, Row, Col} from 'antd';\nimport {ModalContent, FormItem} from '@ra-lib/admin';\nimport config from 'src/commons/config-hoc';\n\nexport default config({\n    modal: {\n        title: (props) => (props.isEdit ? '编辑' : '创建'),\n        width: '70%',\n        top: 50,\n    },\n})(function DepartmentUserEditModal(props) {\n    const { record, isEdit, onOk } = props;\n    const [loading, setLoading] = useState(false);\n    const [form] = Form.useForm();\n\n    const handleSubmit = useCallback(async (values) => {\n        const params = {\n            ...values,\n        };\n\n        if (isEdit) {\n            await props.ajax.put('/department_users', params, { setLoading, successTip: '修改成功！' });\n        } else {\n            await props.ajax.post('/department_users', params, { setLoading, successTip: '修改成功！' });\n        }\n\n        onOk();\n    }, [isEdit, onOk, props.ajax]);\n\n    // 初始化，查询详情数据\n    useEffect(() => {\n        (async () => {\n            const res = await props.ajax.get('/department_users', { id: record?.id }, [], { setLoading });\n            form.setFieldsValue(res || {});\n        })();\n    }, [form, props.ajax, record?.id]);\n\n    const layout = { labelCol: { flex: '100px' } };\n    return (\n        <Form\n            form={form}\n            onFinish={handleSubmit}\n        >\n            <ModalContent\n                loading={loading}\n                okText=\"保存\"\n                okHtmlType=\"submit\"\n                cancelText=\"重置\"\n                onCancel={() => form.resetFields()}\n            >\n                {isEdit ? <FormItem hidden name=\"id\"/> : null}\n                <Row>\n                    <Col span={12}>\n                        <FormItem\n                            {...layout}\n                            type=\"select\"\n                            label=\"部门\"\n                            name=\"departmentId\"\n                        />        \n                    </Col>\n                    <Col span={12}>\n                        <FormItem\n                            {...layout}\n                            type=\"select\"\n                            label=\"用户\"\n                            name=\"userId\"\n                            maxLength={36}\n                        />        \n                    </Col>\n                    <Col span={12}>\n                        <FormItem\n                            {...layout}\n                            type=\"input\"\n                            label=\"是否是领导\"\n                            name=\"isLeader\"\n                        />        \n                    </Col>\n                    <Col span={12}>\n                        <FormItem\n                            {...layout}\n                            type=\"number\"\n                            label=\"排序\"\n                            name=\"order\"\n                        />        \n                    </Col>\n                </Row>\n            </ModalContent>\n        </Form>\n    );\n});"],"sourceRoot":""}